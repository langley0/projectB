{"version":3,"sources":["webpack:///./src/js/stage.js","webpack:///./src ^\\.\\/.*$","webpack:///./src/assets/miluda/miluda_atk_sw.json","webpack:///./src/assets/btn_focusToObject.png","webpack:///./src/assets/elid/elid_atk_sw.png","webpack:///./src/assets/mapdata/walls.json","webpack:///./src/assets/night/idle_nw.png","webpack:///./src/assets/mapdata/map3.json","webpack:///./src/assets/highlight.png","webpack:///./src/assets/ch02_skill02.png","webpack:///./src/assets/ch01_skill02.png","webpack:///./src/assets/mapdata/walls.png","webpack:///./src/js/player.js","webpack:///./src/assets/ending_victory.png","webpack:///./src/assets/border.png","webpack:///./src/js/tweens.js","webpack:///./src/assets/player2.png","webpack:///./src/assets/monster01.png","webpack:///./src/assets/titan/monster2-idle_sw.png","webpack:///./src/assets/night/atk_nw.json","webpack:///./src/assets/night/atk_sw.png","webpack:///./src/assets/monster03_active.png","webpack:///./src/assets/combine.png","webpack:///./src/assets/groundImage.jpg","webpack:///./src/assets/ch02_skill02_on.png","webpack:///./src/assets/ch03_skill02.png","webpack:///./src/assets/elid/elid_idle_nw.json","webpack:///./src/assets/slash_1.json","webpack:///./src/assets/elid/elid_atk_nw.png","webpack:///./src/assets/btn_zoomOut.png","webpack:///./src/assets/night/atk_nw.png","webpack:///./src/assets/window_light.png","webpack:///./src/assets/pbar_r.png","webpack:///./src/assets/titan/monster2-idle_sw.json","webpack:///./src/js/define.js","webpack:///./src/assets/night/idle_sw.png","webpack:///./src/assets/pbar_g.png","webpack:///./src/assets/assets_map.png","webpack:///./src/assets/player1_active.png","webpack:///./src/js/pathfinder.js","webpack:///./src/assets/miluda/miluda_atk_nw.png","webpack:///./src/assets/night/sword_sw.json","webpack:///./src/assets/mapdata/stealBar.png","webpack:///./src/assets/statui.png","webpack:///./src/assets/btn_centralizeToObject.png","webpack:///./src/assets/pbar_o.png","webpack:///./src/assets/monster01_active.png","webpack:///./src/assets/monster02_active.png","webpack:///./src/assets/miluda/miluda_idle_sw.json","webpack:///./src/main.js","webpack:///./src/assets/miluda/miluda_atk_sw.png","webpack:///./src/assets/miluda/miluda_atk_nw.json","webpack:///./src/js/movieclip.js","webpack:///./src/assets/mapdata/stealBarL.png","webpack:///./src/assets/night/walk_nw.json","webpack:///./src/assets/player2_active.png","webpack:///./src/js/moveengine.js","webpack:///./src/assets/slash_1.png","webpack:///./src/assets/dialog.png","webpack:///./src/assets/night/walk_sw.png","webpack:///./src/assets/ending.png","webpack:///./src/assets/mapdata/map2.json","webpack:///./src/assets/btn_centralize.png","webpack:///./src/assets/ch03_skill01.png","webpack:///./src/assets/inventory.png","webpack:///./src/assets/night/sword_sw.png","webpack:///./src/assets/pbar.png","webpack:///./src/assets/combine_listitem.png","webpack:///./src/assets/player3.png","webpack:///./src/assets/player1.png","webpack:///./src/assets/assets_characters.png","webpack:///./src/assets/ch01_skill02_on.png","webpack:///./src/assets/medusa/monster1-atk_sw.json","webpack:///./src/js/tile.js","webpack:///./src/assets/elid/elid_idle_nw.png","webpack:///./src/assets/mapdata/objects.png","webpack:///./src/js/resource-manager.js","webpack:///./src/assets/monster02.png","webpack:///./src/assets/ui/chatballon_comma.png","webpack:///./src/assets/mapdata/objects.json","webpack:///./src/assets/btn_zoomIn.png","webpack:///./src/js/game.js","webpack:///./src/assets/background.png","webpack:///./src/assets/night/walk_sw.json","webpack:///./src/assets/combine_button.png","webpack:///./src/assets/elid/elid_idle_sw.png","webpack:///./src/assets/night/idle_sw.json","webpack:///./src/assets/battle-turn_enemy.png","webpack:///./src/assets/elid/elid_atk_sw.json","webpack:///./src/assets/assets_map.json","webpack:///./src/assets/night/walk_nw.png","webpack:///./src/assets/monster03.png","webpack:///./src/assets/mapdata/map.json","webpack:///./src/assets/miluda/miluda_idle_nw.png","webpack:///./src/assets/ch01_skill01.png","webpack:///./src/assets/medusa/monster1-atk_sw.png","webpack:///./src/assets/battle-turn_player.png","webpack:///./src/assets/ch02_skill01_on.png","webpack:///./src/assets/player3_active.png","webpack:///./src/js/battle.js","webpack:///./src/assets/ui/chatballon.png","webpack:///./src/assets/miluda/miluda_idle_sw.png","webpack:///./src/assets/ch01_skill01_on.png","webpack:///./src/assets/titan/monster2-atk_sw.json","webpack:///./src/assets/mapdata/stealBarR.png","webpack:///./src/js/explore.js","webpack:///./src/assets/assets_characters.json","webpack:///./src/assets/miluda/miluda_idle_nw.json","webpack:///./src/assets/mapdata/tiles.json","webpack:///./src/js/ui.js","webpack:///./src/assets/theater.png","webpack:///./src/assets/items/item3.png","webpack:///./src/assets/elid/elid_idle_sw.json","webpack:///./src/assets/torch_light.png","webpack:///./src/assets/player3_active2.png","webpack:///./src/assets/opening.png","webpack:///./src/assets/titan/monster2-atk_sw.png","webpack:///./src/assets/player2_active2.png","webpack:///./src/assets/player1_active2.png","webpack:///./src/assets/elid/elid_death_nw.png","webpack:///./src/assets/night/sword_nw.json","webpack:///./src/assets/ch03_skill01_on.png","webpack:///./src/assets/night/sword_nw.png","webpack:///./src/assets/medusa/monster1_idle_sw.json","webpack:///./src/assets/elid/elid_atk_nw.json","webpack:///./src/assets/ch02_skill01.png","webpack:///./src/assets/windowlight.png","webpack:///./src/assets/mapdata/tiles.png","webpack:///./src/assets/ch03_skill02_on.png","webpack:///./src/assets/night/atk_sw.json","webpack:///./src/assets/medusa/monster1_idle_sw.png","webpack:///./src/assets/dialogtitle.png","webpack:///./src/assets/shadow.png","webpack:///./src/assets/night/idle_nw.json","webpack:///./src/js/character.js"],"names":["Gate","x","y","tileData","__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_classCallCheck___default","this","_this","__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_possibleConstructorReturn___default","__proto__","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_get_prototype_of___default","call","base","direction","DIRECTIONS","SW","PIXI","Texture","fromFrame","bar1","Sprite","Rectangle","width","bar2","bar3","height","addChild","openRatio","tags","indexOf","needsKey","tweens","addTween","duration","game","isOpened","keyItem","player","inventory","getItemByType","ui","showDialog","open","deleteItem","itemId","value","position","_openRatio","Tile","Chest","_this2","isInteractive","animations","setTexture","textureName","_this3","itemType","addItem","battleMode","callback","onItemAdded","enterStage","showItemAcquire","showChatBallon","Anvil","_this4","firstTouch","showCombine","Stage","tileWidth","tileHeight","_this5","getTilePosXFor","c","r","TILE_HALF_W","getTilePosYFor","TILE_HALF_H","mapWidth","mapHeight","tiles","groundMap","Array","objectMap","mapContainer","Container","groundContainer","objectContainer","overlayContainer","interactive","pathFinder","PathFinder","moveEngine","MoveEngine","Tweens","currentScale","currentZoom","posFrame","w","h","externalCenter","mapVisualWidthReal","mapVisualHeightReal","currentFocusLocation","centralizeToPoint","obj","strength","size","vibrate","setTimeout","scale","instantZoom","mapVisualWidthScaled","diff","oldScale","setScale","ratio","s","mapVisualHeightScaled","set","px","py","instantRelocate","id","options","tileId","getTileData","tile","objectType","generateTile","tileid","index","groundTile","setCell","movable","objectTile","setDynamicCell","event","checkForTileClick","data","mdata","localPoint","toLocal","global","selectedTile","getTileFromLocalPos","onTileSelected","gridX","gridY","point","cx","cy","Math","abs","character","container","addObjRefToLocation","arrangeDepthsFromLocation","target","getInteractiveTarget","ignoreTarget","startX","currentTargetTile","startY","path","solve","interactTarget","isMoving","newPath","moveObjThrough","getObjectAt","currentTarget","stopObject","undefined","length","showPathHighlight","highlightPath","currentPath","currentPathStep","speedMagnitude","onObjMoveStepBegin","onObjMoveStepEnd","removeMovable","currentDirection","x1","y1","x2","y2","SE","NW","NE","getDirection","changeVisualToDirection","setMoveParameters","addMovable","pathEnded","forceStop","onTilePassing","onTouchObject","slice","i","pathItem","getGroundTileAt","setHighlighted","pos","vertices","gp","testy","testx","nvert","j","isInPolygon","arrangeObjLocation","arrangeObjTransperancies","_this6","instantFollow","prevX","prevY","a","alpha","rect1","getBounds","rect2","removeObjRefFromLocation","removeChild","update","map","./assets/assets_characters.json","./assets/assets_characters.png","./assets/assets_map.json","./assets/assets_map.png","./assets/background.png","./assets/battle-turn_enemy.png","./assets/battle-turn_player.png","./assets/border.png","./assets/btn_centralize.png","./assets/btn_centralizeToObject.png","./assets/btn_focusToObject.png","./assets/btn_zoomIn.png","./assets/btn_zoomOut.png","./assets/ch01_skill01.png","./assets/ch01_skill01_on.png","./assets/ch01_skill02.png","./assets/ch01_skill02_on.png","./assets/ch02_skill01.png","./assets/ch02_skill01_on.png","./assets/ch02_skill02.png","./assets/ch02_skill02_on.png","./assets/ch03_skill01.png","./assets/ch03_skill01_on.png","./assets/ch03_skill02.png","./assets/ch03_skill02_on.png","./assets/combine.png","./assets/combine_button.png","./assets/combine_listitem.png","./assets/dialog.png","./assets/dialogtitle.png","./assets/elid/elid_atk_nw.json","./assets/elid/elid_atk_nw.png","./assets/elid/elid_atk_sw.json","./assets/elid/elid_atk_sw.png","./assets/elid/elid_death_nw.png","./assets/elid/elid_idle_nw.json","./assets/elid/elid_idle_nw.png","./assets/elid/elid_idle_sw.json","./assets/elid/elid_idle_sw.png","./assets/ending.png","./assets/ending_victory.png","./assets/groundImage.jpg","./assets/highlight.png","./assets/inventory.png","./assets/items/item3.png","./assets/mapdata/map.json","./assets/mapdata/map2.json","./assets/mapdata/map3.json","./assets/mapdata/objects.json","./assets/mapdata/objects.png","./assets/mapdata/stealBar.png","./assets/mapdata/stealBarL.png","./assets/mapdata/stealBarR.png","./assets/mapdata/tiles.json","./assets/mapdata/tiles.png","./assets/mapdata/walls.json","./assets/mapdata/walls.png","./assets/medusa/monster1-atk_sw.json","./assets/medusa/monster1-atk_sw.png","./assets/medusa/monster1_idle_sw.json","./assets/medusa/monster1_idle_sw.png","./assets/miluda/miluda_atk_nw.json","./assets/miluda/miluda_atk_nw.png","./assets/miluda/miluda_atk_sw.json","./assets/miluda/miluda_atk_sw.png","./assets/miluda/miluda_idle_nw.json","./assets/miluda/miluda_idle_nw.png","./assets/miluda/miluda_idle_sw.json","./assets/miluda/miluda_idle_sw.png","./assets/monster01.png","./assets/monster01_active.png","./assets/monster02.png","./assets/monster02_active.png","./assets/monster03.png","./assets/monster03_active.png","./assets/night/atk_nw.json","./assets/night/atk_nw.png","./assets/night/atk_sw.json","./assets/night/atk_sw.png","./assets/night/idle_nw.json","./assets/night/idle_nw.png","./assets/night/idle_sw.json","./assets/night/idle_sw.png","./assets/night/sword_nw.json","./assets/night/sword_nw.png","./assets/night/sword_sw.json","./assets/night/sword_sw.png","./assets/night/walk_nw.json","./assets/night/walk_nw.png","./assets/night/walk_sw.json","./assets/night/walk_sw.png","./assets/opening.png","./assets/pbar.png","./assets/pbar_g.png","./assets/pbar_o.png","./assets/pbar_r.png","./assets/player1.png","./assets/player1_active.png","./assets/player1_active2.png","./assets/player2.png","./assets/player2_active.png","./assets/player2_active2.png","./assets/player3.png","./assets/player3_active.png","./assets/player3_active2.png","./assets/shadow.png","./assets/slash_1.json","./assets/slash_1.png","./assets/statui.png","./assets/theater.png","./assets/titan/monster2-atk_sw.json","./assets/titan/monster2-atk_sw.png","./assets/titan/monster2-idle_sw.json","./assets/titan/monster2-idle_sw.png","./assets/torch_light.png","./assets/ui/chatballon.png","./assets/ui/chatballon_comma.png","./assets/window_light.png","./assets/windowlight.png","./js/battle","./js/battle.js","./js/character","./js/character.js","./js/define","./js/define.js","./js/explore","./js/explore.js","./js/game","./js/game.js","./js/moveengine","./js/moveengine.js","./js/movieclip","./js/movieclip.js","./js/pathfinder","./js/pathfinder.js","./js/player","./js/player.js","./js/resource-manager","./js/resource-manager.js","./js/stage","./js/stage.js","./js/tile","./js/tile.js","./js/tweens","./js/tweens.js","./js/ui","./js/ui.js","./main","./main.js","webpackContext","req","__webpack_require__","webpackContextResolve","Error","keys","Object","resolve","module","exports","p","loadAniTexture","name","count","frames","push","Player","__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_classCallCheck___default","__WEBPACK_IMPORTED_MODULE_4_babel_runtime_helpers_possibleConstructorReturn___default","__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_object_get_prototype_of___default","Inventory","Knight","portrait","skillAIcon","skillBIcon","hp","maxHp","damage","balance","ciriticalRate","ciriticalBalance","defense","idle_nw","textures","flipX","idle_sw","idle_ne","idle_se","walk_nw","walk_sw","walk_ne","walk_se","attack_nw","attack_sw","attack_ne","attack_se","anim","extras","AnimatedSprite","animationSpeed","play","hpHolder","hpBar","Character","items","item","Item","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_get_iterator___default","next","done","err","return","splice","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","linearTween","t","b","d","easeInQuad","easeOutQuad","easeOutQuad_ex","floor","easeInOutQuad","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_classCallCheck___default","activeForTweens","processFrame","tweenTargets","fps","o","vars","delay","easing","overwrite","onComplete","e","v","prop","easingFunc","totalFrames","delayFrame","currentFrame","targetRemoved","idx","idx2","console","log","len","removeTween","defineProperty","__webpack_exports__","GridNode","weight","ignoreCollide","fromNeighbor","dynamicWeight","BinaryHeap","scoreFunction","content","element","sinkDown","result","end","pop","bubbleUp","node","n","parentN","parent","elemScore","child2N","child1N","swap","child1Score","child1","child2","nodes","grid","dirtyNodes","cleanNode","f","g","visited","closed","originX","originY","destX","destY","start","search","init","heuristic","pos0","pos1","openHeap","closestNode","currentNode","pathTo","neighbors","il","neighbor","isWall","gScore","getCost","beenVisited","markDirty","rescoreElement","curr","ret","__WEBPACK_IMPORTED_MODULE_0__js_game__","__WEBPACK_IMPORTED_MODULE_1__js_ui__","__WEBPACK_IMPORTED_MODULE_2__js_resource_manager__","pixi","Application","backgroundColor","forceCanvas","document","body","appendChild","view","loader","ResourceManager","add","load","sprite","stage","mouseup","removeChildren","Game","resourceManager","UI","stagePath","game_update","requestAnimationFrame","toggle","window","addEventListener","keyCode","hideCombine","gameStart","initApp","EasingFunction","linear","outCubic","inCubic","inOutCubic","inOutSine","cos","PI","outExponential","pow","outBounce","outBack","MoveClipPlayMode","Loop","Stop","Destory","MovieClip","_len","arguments","timelines","_key","isArray","_timelines","_frame","_playing","_stopHandler","_mode","lastFrame","tl","max","endFrame","_lastFrame","startFrame","mesh","handler","timeline","dist","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","tween","from","to","image","setRotation","engine","activeForMovables","movables","object","speed","speedUnit","getUnit","m","sqrt","pos2","positionR","currentReachThresh","ceil","getDist","checkForTileChange","checkForFollowCharacter","TILE_WIDTH","TILE_HEIGHT","texture","tileTexture","highlightedOverlay","Graphics","clear","lineStyle","beginFill","moveTo","lineTo","endFill","visible","isHighlighted","cache","getNewLoader","loaders","Loader","pre","memoryMiddleware","bind","resource","url","complete","once","require","onLoadComplete","_","resources","renderer","screenWidth","screenHeight","background","gamelayer","foreground","onGameClick","onForegroundClick","blackScreen","WHITE","tint","Battle","exploreMode","Explore","currentMode","nextStageMode","whiteScreen","playerInfo","mode","currentStage","loadStage","onStageLoadCompleted","backupX","backupY","backup","fromBattle","mapData","tilewidth","tileheight","tilesets","tileset","source","prefix","replace","idStart","firstgid","customTileData","custom","animation","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_step4","_iterator4","_iteratorNormalCompletion5","_didIteratorError5","_iteratorError5","_step5","_iterator5","properties","property","split","tilecount","utils","TextureCache","columns","createElement","getContext","drawImage","fromCanvas","addToCache","addTile","layers","layer","setGroundTile","setObjectTile","light","anchor","blendMode","BLEND_MODES","ADD","build","zoomTo","prepare","getDirectionName","dir","__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_classCallCheck___default","__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_get_prototype_of___default","Wizard","Archer","Troll","ani","gotoAndPlay","Medusa","Wolf","movies","players","enemies","loadCharacter","cutscene","showTheaterScreen","battleUi","setBattleUi","focusBattleCenter","battleIntro","spawnPoint","addCharacter","player_2","player_3","enemy","enemy_2","enemy_3","_this7","flow","intro","focusBattleObject","hideTheaterScreen","showUi","forEach","setUiVisible","turnCount","nextTurn","_this8","enemiesLength","playerLength","gameEnd","showStageTitle","status","turn","_this9","hideUi","victory","onEndTurn","_this10","waitCommand","command","opponent","movieClip","Timeline","setAnimation","currentDir","loop","round","random","fontColor","onDamage","type","critical","hitEffect","playAndStop","onCommandCallback","getCommand","color","style","TextStyle","dropShadow","dropShadowDistance","fontStyle","fontWeight","fontSize","fill","text","Text","movie","moveCharacter","close","stopped","touch","BaseModal","plane","NineSlicePlane","onClick","onclose","fontFamily","align","titleText","textMetrics","TextMetrics","measureText","titlePlane","ChatBallon","chatText","follower","wordWrap","wordWrapWidth","comma","updatePosition","gpos","toGlobal","Point","Dialog","innerWidth","dialogText","StageTitle","title","underline","InventoryUI","playerInventory","eachItem","itemSpr","CombineUI","evt","button","itemA","itemB","showRecipe","clicked","recipe","colorA","colorB","styleA","textA","styleB","textB","styleC","textC","BattleUI","playersPortraits","enemiesPortraits","playerUi","enemyUi","makePlayerUi","makeEnemiesUi","newBattleUi","skillA","skillB","_this11","playerIndex","enemyIndex","_this12","removeAllListeners","_this13","on","disableInteractive","_this14","dialog","theater","chatBallons","combine","closeCallback","setText","_this15","titleScale","_this16","itemAcquire","addTitle","itemSprite","acquireText","itemText","_this17","chat","shadow","flag","hpWidth","vibrateObj","slash","updateStatus","checkDie","func"],"mappings":"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","file":"static/js/app.4f74148630d09bacc4aa.js","sourcesContent":["import { DIRECTIONS } from './define';\r\nimport MoveEngine from './moveengine';\r\nimport PathFinder from './pathfinder';\r\nimport Tile from './tile';\r\nimport Tweens from './tweens';\r\n\r\nfunction hitTestRectangle(rect1, rect2) {\r\n    return  (rect1.x < rect2.x + rect2.width &&\r\n    rect1.x + rect1.width > rect2.x &&\r\n    rect1.y < rect2.y + rect2.height &&\r\n    rect1.y + rect1.height > rect2.y);\r\n};\r\n\r\n\r\n// \r\nclass Gate extends Tile {\r\n    constructor(x, y, tileData) {\r\n        super(x, y, tileData);\r\n\r\n        // 철망을 붙인다\r\n        const base = (tileData.direction === DIRECTIONS.SW) ?\r\n                PIXI.Texture.fromFrame(\"stealBarL.png\") : \r\n                PIXI.Texture.fromFrame(\"stealBarR.png\");\r\n\r\n        this.base = base;\r\n        this.bar1 = new PIXI.Sprite(new PIXI.Texture(base, new PIXI.Rectangle(0, 0, base.width, 50)));\r\n        this.bar2 = new PIXI.Sprite(new PIXI.Texture(base, new PIXI.Rectangle(0, 50, base.width, 40)));\r\n        this.bar3 = new PIXI.Sprite(new PIXI.Texture(base, new PIXI.Rectangle(0, 90, base.width, base.height - 90)));\r\n        this.addChild(this.bar1);\r\n        this.addChild(this.bar2);\r\n        this.addChild(this.bar3);\r\n\r\n        // 초기값을 설정할 수 있어야 한다\r\n        this.openRatio = 1; // 기본으로 닫아놓는다\r\n        \r\n        // 열쇠로 열수 있는지 확인한다\r\n        if (tileData.tags && tileData.tags.indexOf(\"key\") >= 0) {\r\n            this.needsKey = true;\r\n        }\r\n    }\r\n\r\n    set openRatio(value) {\r\n        // 0이면 닫힌거고 1 이면 열린것\r\n        this.bar1.position.y = -this.base.height;\r\n        \r\n        this.bar2.position.y = this.bar1.position.y + this.bar1.height;\r\n        this.bar2.height = value * 40;\r\n        \r\n        this.bar3.position.y = this.bar1.position.y + 50 + this.bar2.height;\r\n\r\n        this._openRatio = value;\r\n        this.duration = 0.5;\r\n    }\r\n\r\n    open(tweens) {\r\n        if (tweens) {\r\n            // 열쇠가 돌아가는 시간을 조금 벌어야 한다. 바로 열리면 뭔가 이상하다\r\n            tweens.addTween(this, this.duration, { openRatio: 0 }, 0.5, \"easeInOut\", true);\r\n        } else {\r\n            this.openRatio = 0;\r\n        }\r\n    }\r\n\r\n    close(tweens) {\r\n        if (tweens) {\r\n            \r\n            tweens.addTween(this, this.duration, { openRatio: 1 }, 0, \"easeInOut\", true);\r\n        } else {\r\n            this.openRatio = 1;\r\n        }\r\n    }\r\n\r\n    get openRatio() {\r\n        return this._openRatio;\r\n    }\r\n\r\n    get isOpened() {\r\n        return this._openRatio <= 0;\r\n    }\r\n\r\n    get isInteractive() {\r\n        if (this.isOpened) {\r\n            // 열린문은 인터랙트 하지 않아도 된다\r\n            // 다시 닫을 일이 있을까?\r\n            return false;\r\n        } else {\r\n            return true;\r\n        }\r\n    }\r\n\r\n    touch(game) {\r\n        // 다이얼로그를 연다\r\n        if (!this.isOpened) {\r\n            if (this.needsKey) {\r\n                // 열쇠를 가지고 있는지 검사한다\r\n                const keyItem = game.player.inventory.getItemByType(3);\r\n                if (keyItem) {\r\n                    game.ui.showDialog(\"문을 열었다!\");\r\n                    this.open(game.tweens);\r\n                    // 열쇠를 파괴한다\r\n                    game.player.inventory.deleteItem(keyItem.itemId);\r\n                } else {\r\n                    game.ui.showDialog(\"문을 열기 위해서 열쇠가 필요하다\");\r\n                }\r\n                \r\n            } else {\r\n                game.ui.showDialog(\"이 문은 열리지 않을 것 같다\\n\\n다른 문을 찾아보자\");\r\n            }\r\n        }\r\n    }\r\n    \r\n}   \r\n\r\nclass Chest extends Tile {\r\n    constructor(x, y, tileData) {\r\n        super(x, y, tileData);\r\n\r\n        this.isInteractive = true;\r\n        this.isOpened = false;\r\n\r\n        // 자신의 타일 모양을 바꾸어야 한다\r\n        this.animations = tileData.animations;\r\n    }\r\n\r\n    open() {\r\n        // TODO : 애니메이션을 플레이 해야한다\r\n        // 텍스쳐 변경\r\n        this.setTexture(PIXI.Texture.fromFrame(this.animations[1].textureName));\r\n\r\n        this.isOpened = true;\r\n    }\r\n\r\n    touch(game) {\r\n        if (this.isOpened) {\r\n            game.ui.showDialog(\"상자는 비어있다.\");\r\n        } else {\r\n            this.open();\r\n            // TODO : 아이템 아이디가 어딘가 있어야 하는데.. 일단 1,2번이 열쇠조각, 3번이 열쇠이다\r\n            let itemType;\r\n            if (!game.player.inventory.getItemByType(1))  {\r\n                game.player.inventory.addItem(1, 1);\r\n                itemType = 1;\r\n            } else if (!game.player.inventory.getItemByType(2))  {\r\n                game.player.inventory.addItem(2, 2);\r\n                itemType = 2;\r\n            }\r\n            \r\n            // 두번째상자에서 몬스터가 나오게 한다\r\n            if (itemType === 2) {\r\n                game.battleMode.callback = () => {\r\n                    this.onItemAdded(game, itemType);\r\n                };\r\n                game.enterStage('assets/mapdata/map2.json', \"battle\");\r\n            } else {\r\n                this.onItemAdded(game, itemType);\r\n            }\r\n        }\r\n    }\r\n\r\n    onItemAdded(game, itemType) {\r\n        game.ui.showItemAcquire(itemType, () => {\r\n            // TODO:  모달 클로즈 이벤트를 만들어야 한다\r\n            // 트리거를 만들어야 한다!!\r\n\r\n            if (game.player.inventory.getItemByType(1) && \r\n                game.player.inventory.getItemByType(2)) {\r\n\r\n                game.ui.showChatBallon(game.player, \"열쇠조각은 모두 모았어!!\\n아까 모루를 본 것 같은데 \\n그쪽으로 가보자\", 4);\r\n            } else {\r\n                game.ui.showChatBallon(game.player, \"열쇠조각이다! 나머지 조각도 어딘가 있을거야\", 4);\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\nclass Anvil extends Tile {\r\n    constructor(x, y, tileData) {\r\n        super(x, y, tileData);\r\n\r\n        this.isInteractive = true;\r\n        this.firstTouch = true;\r\n    }\r\n\r\n    touch(game) {\r\n        if (this.firstTouch) {\r\n            this.firstTouch = false;\r\n            game.ui.showDialog(\"모루를 발견하였다\\n\\n새로운 아이템을 조합할 수 있게 되었다\", () => {\r\n                game.ui.showCombine();\r\n            });\r\n        } else {\r\n            game.ui.showCombine();\r\n        }\r\n    }\r\n}\r\n\r\n\r\nfunction getDirection(x1, y1, x2, y2) {\r\n    if (x1 === x2) {\r\n        if (y1 < y2) { return DIRECTIONS.SE; }\r\n        else if (y1 > y2) { return DIRECTIONS.NW; }\r\n    }\r\n    else if (y1 === y2) {\r\n        if (x1 < x2) { return DIRECTIONS.NE; }\r\n        else if (x1 > x2)\t{ return DIRECTIONS.SW; }\r\n    }\r\n    return null;\r\n}\r\n\r\nfunction isInPolygon(gp, vertices) {\r\n\tconst testy = gp.y;\r\n\tconst testx = gp.x;\r\n\tconst nvert = vertices.length;\r\n\tlet c = false;\r\n\tfor (let i = 0, j = nvert - 1; i < nvert; j = i++) {\r\n\t\tif ( ((vertices[i][1] > testy) !== (vertices[j][1] > testy)) && \r\n\t\t\t(testx < (vertices[j][0] - vertices[i][0]) * (testy - vertices[i][1]) / (vertices[j][1] - vertices[i][1]) + vertices[i][0]) )\r\n\t\t{\r\n\t\t\tc = !c;\r\n\t\t}\r\n\t}\r\n\treturn c;\r\n};\r\n\r\nexport default class Stage extends PIXI.Container {\r\n    constructor(width, height, tileWidth, tileHeight) {\r\n        super();\r\n\r\n        this.mapWidth = width;\r\n        this.mapHeight = height;\r\n        this.tileWidth = tileWidth;\r\n        this.tileHeight = tileHeight;\r\n        this.TILE_HALF_W = tileWidth / 2;\r\n        this.TILE_HALF_H = tileHeight / 2;\r\n\r\n        this.tiles = {}\r\n        this.groundMap = new Array(height * width);\r\n        this.objectMap = new Array(height * width);\r\n       \r\n        this.mapContainer = new PIXI.Container();\r\n\t    this.addChild(this.mapContainer);\r\n\r\n        this.groundContainer = new PIXI.Container();\r\n        this.objectContainer = new PIXI.Container()\r\n        this.overlayContainer = new PIXI.Container()\r\n\r\n        this.mapContainer.addChild(this.groundContainer);\r\n        this.mapContainer.addChild(this.objectContainer);\r\n        this.mapContainer.addChild(this.overlayContainer);\r\n        \r\n        this.interactive = true;\r\n\r\n        this.pathFinder = new PathFinder(this.mapWidth, this.mapHeight);\r\n        this.moveEngine = new MoveEngine(this);\r\n        this.tweens = new Tweens();\r\n\r\n        this.currentScale = 1.0;\r\n        this.currentZoom = 0;\r\n    \r\n        this.posFrame = { x : 0, y : 0, w : 980, h : 500 };\r\n        this.externalCenter = {\r\n            x : this.posFrame.w >> 1,\r\n            y : this.posFrame.h >> 1\r\n        };\r\n\r\n        this.mapVisualWidthReal = this.getTilePosXFor(this.mapWidth - 1,this.mapHeight - 1) - this.getTilePosXFor(0,0);\r\n\t    this.mapVisualHeightReal = this.getTilePosYFor(this.mapWidth - 1,0) - this.getTilePosYFor(0,this.mapHeight - 1);\r\n\r\n        this.currentFocusLocation = { x: this.mapWidth >> 1, y: this.mapHeight >> 1 };\r\n\t\tthis.centralizeToPoint(this.externalCenter.x, this.externalCenter.y, true);\r\n    }\r\n\r\n    // Obj를 흔들어주는 function 이런건 유틸쪽으로 빼야할까..?..\r\n    // set Timeout 을 사용하는게 맞는가..? MovieClip Timeline이 있는데\r\n    vibrateObj(obj, strength, callback) {\r\n        var size = strength ? strength : 4;\r\n        var x = obj.position.x;\r\n        var y = obj.position.y;\r\n\r\n        var vibrate = () => {\r\n            setTimeout(() => {\r\n                obj.position.x = x;\r\n                obj.position.y = y;\r\n                if (size < -1 || size > 1) {\r\n                    obj.position.x += size;\r\n                    obj.position.y += size;\r\n                    size = size / -4 * 3;\r\n                    vibrate();\r\n                } else {\r\n                    callback ? callback() : null;\r\n                }\r\n            }, 30);\r\n        };\r\n\r\n        vibrate();\r\n    }\r\n\r\n    zoomTo(scale, instantZoom) {\r\n        \r\n        this.externalCenter = this.externalCenter ? this.externalCenter : { x: (this.mapVisualWidthScaled >> 1), y: 0 };\r\n        const diff = { x: this.mapContainer.position.x + (this.mapVisualWidthScaled >> 1) - this.externalCenter.x, y: this.mapContainer.position.y - this.externalCenter.y };\r\n        const oldScale = this.currentScale;\r\n        \r\n        this.setScale(scale, instantZoom);\r\n        \r\n        const ratio = this.currentScale / oldScale;\r\n        this.centralizeToPoint(this.externalCenter.x + diff.x * ratio, this.externalCenter.y + diff.y * ratio, instantZoom);\r\n    }\r\n\r\n    setScale(s, instantZoom) {\r\n        this.currentScale = s;\r\n        this.mapVisualWidthScaled = this.mapVisualWidthReal * this.currentScale;\r\n        this.mapVisualHeightScaled = this.mapVisualHeightReal * this.currentScale;\r\n        \r\n        if (instantZoom) {\r\n            this.mapContainer.scale.set(this.currentScale);\r\n        } else {\r\n            this.tweens.addTween(this.mapContainer.scale, 0.5, { x: this.currentScale, y: this.currentScale }, 0, \"easeInOut\", true );\r\n        }\r\n    }\r\n\r\n    centralizeToPoint(px, py, instantRelocate) {\r\n        if (instantRelocate) {\r\n            this.mapContainer.position.x = px;\r\n            this.mapContainer.position.y = py;\r\n        }\r\n        else {\r\n            this.tweens.addTween(this.mapContainer.position, 0.5, { x: px, y: py }, 0, \"easeInOut\", true );\r\n        }\r\n    }\r\n\r\n    addTile(id, textureName, options) {\r\n        options = options || {};\r\n        options.textureName = textureName;\r\n        this.tiles[id] = options;\r\n            \r\n    }\r\n\r\n    generateTile(x, y, tileId) {\r\n        const tileData = this.getTileData(tileId);\r\n        let tile;\r\n        if (tileData.objectType === \"gate\") {\r\n            tile = new Gate(x, y, tileData);\r\n        } else if (tileData.objectType === \"chest\") {\r\n            tile = new Chest(x, y, tileData);\r\n        }  else if (tileData.objectType === \"anvil\") {\r\n            tile = new Anvil(x, y, tileData);\r\n        }\r\n        else {\r\n            tile = new Tile(x, y, tileData);\r\n        }\r\n        tile.position.x = this.getTilePosXFor(x, y) - this.TILE_HALF_W;\r\n        tile.position.y = this.getTilePosYFor(x ,y) + this.TILE_HALF_H;\r\n        return tile;\r\n    }\r\n\r\n    setGroundTile(x, y, tileId) {\r\n        if (tileId > 0) {\r\n            this.groundMap[x + y * this.mapWidth] = this.generateTile(x, y, tileId);\r\n        }\r\n    }\r\n\r\n    setObjectTile(x, y, tileId) {\r\n        if (tileId > 0) {\r\n            this.objectMap[x + y * this.mapWidth] = this.generateTile(x, y, tileId);\r\n\r\n        }\r\n    }\r\n\r\n    getTilePosXFor = function(c, r) {\r\n        return (c * this.TILE_HALF_W) + (r * this.TILE_HALF_W);\r\n    };\r\n\r\n    getTilePosYFor = function(c, r) {\r\n        return (r * this.TILE_HALF_H) - (c * this.TILE_HALF_H);\r\n    }\r\n    \r\n    getGroundTileAt(x, y) {\r\n        return this.groundMap[x + y*this.mapWidth];\r\n    }\r\n\r\n    getObjectAt(x, y) {\r\n        return this.objectMap[x + y*this.mapWidth];\r\n    }\r\n\r\n    getTileData(tileid) {\r\n        return this.tiles[tileid];\r\n    }\r\n\r\n    build() {\r\n        for (let y = 0; y < this.mapHeight; y++ ) {\r\n            for (let x = this.mapWidth - 1; x >= 0; --x) {\r\n                const index = x + y * this.mapWidth;\r\n                const groundTile = this.groundMap[index];\r\n\r\n                if (groundTile) {\r\n                    this.groundContainer.addChild(groundTile);\r\n                    this.pathFinder.setCell(x, y, groundTile.movable);\r\n                }\r\n\r\n                const objectTile = this.objectMap[index];\r\n                if (objectTile) {\r\n                    this.objectContainer.addChild(objectTile);   \r\n                    this.pathFinder.setDynamicCell(x, y, objectTile.movable);\r\n                }\r\n                \r\n            }\r\n        }\r\n    }\r\n\r\n    onMouseUp(event) {\r\n        this.checkForTileClick(event.data);\r\n    }\r\n\r\n    checkForTileClick(mdata) {\r\n        const localPoint = this.mapContainer.toLocal(mdata.global);\r\n        const selectedTile = this.getTileFromLocalPos(localPoint);\r\n        if (selectedTile) {\r\n           if (this.onTileSelected) {\r\n                this.onTileSelected(selectedTile.gridX, selectedTile.gridY);\r\n           }\r\n        }\r\n    }\r\n\r\n    getTileFromLocalPos(point) {\r\n        // 화면의 좌표를 구하는 방식을 역산한다.\r\n        // 중앙 센터포지션을 중심으로 바닥 타일을 감싸는 사각형을 그린다\r\n        // 이 사각형들은 겹쳐있기 때문에 여러개의 중첩되어서 나오게 된다.\r\n        // 이 중첩된 사각형중에 하나를 찾으면 된다.\r\n\r\n        // 찾기 귀찮으니 모든 타일을 검사하자..\r\n        for (let y = 0; y < this.mapHeight; ++y) {\r\n            for (let x = 0; x < this.mapWidth; ++x) {\r\n                // 중앙 포지션을 구한다\r\n                const cx = this.getTilePosXFor(x, y);\r\n                const cy = this.getTilePosYFor(x ,y);\r\n\r\n                if (cx - this.TILE_HALF_W <= point.x && point.x < cx + this.TILE_HALF_W && \r\n                    cy - this.TILE_HALF_H <= point.y && point.y < cy + this.TILE_HALF_H) {\r\n\r\n                    // 타일마름모 안에 있는지 확인한다\r\n                    if (Math.abs(point.x - cx) * this.TILE_HALF_H / this.TILE_HALF_W + Math.abs(point.y - cy) <= this.TILE_HALF_H) {\r\n                        const index = x + y * this.mapWidth;\r\n                        return this.groundMap[index];\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    addCharacter(character, x, y) {\r\n        // 해당 좌표에 오브젝트를 추가한다\r\n        // 오브젝트가 없는 곳에만 오브젝트를 추가할수 있다 (현재는)\r\n        const px = this.getTilePosXFor(x, y);\r\n        const py = this.getTilePosYFor(x, y);\r\n\r\n        character.position.x = px;\r\n        character.position.y = py;\r\n\r\n        character.container.position.x = - this.TILE_HALF_W;\r\n        character.container.position.y = this.TILE_HALF_H;\r\n\r\n        this.addObjRefToLocation(character, x, y);\r\n        this.arrangeDepthsFromLocation(x, y);\r\n    }\r\n\r\n    moveCharacter(character, x, y) {\r\n\r\n        const target = this.getInteractiveTarget(x, y);\r\n        const ignoreTarget = target ? true : false;\r\n\r\n        // 다음 위치에서부터 시작을 한다\r\n        const startX = character.currentTargetTile ? character.currentTargetTile.x : character.gridX;\r\n        const startY = character.currentTargetTile ? character.currentTargetTile.y : character.gridY;\r\n        const path  = this.pathFinder.solve(startX, startY, x, y, ignoreTarget);\r\n\r\n        if (path) {\r\n            if (path[0].x === x && path[0].y === y) {\r\n                // 타겟을 설정한다\r\n                this.interactTarget = target;\r\n            } else {\r\n                this.interactTarget = null;\r\n            }\r\n            \r\n            // 길을 찾는다\r\n            if (character.isMoving) {\r\n                character.newPath = path;\r\n            } else {\r\n                this.moveObjThrough(character, path);\r\n            }\r\n        }\r\n    }\r\n\r\n    getInteractiveTarget(x, y) {\r\n        const target = this.getObjectAt(x, y);\r\n        if (target && target.isInteractive) {\r\n            return target;\r\n        }\r\n        return null;\r\n    }\r\n\r\n    moveObjThrough(obj, path) {\r\n        if (obj.currentTarget) {\r\n            this.stopObject(obj);\r\n        }\r\n\r\n        if (obj.newPath) {\r\n            path = obj.newPath;\r\n            obj.newPath = undefined;\r\n        }\r\n\r\n        if (path.length == 0) {\r\n            this.onObjMoveStepEnd(obj);\r\n            return;\r\n        }\r\n\r\n        const isControlCharacter = true;\r\n        if (isControlCharacter & this.showPathHighlight) {\r\n            this.highlightPath(obj.currentPath, path);\r\n        }\r\n\r\n        obj.currentPath = path;\r\n        obj.currentPathStep = obj.currentPath.length - 1;\r\n        obj.currentTargetTile = obj.currentPath[obj.currentPathStep];\r\n        obj.speedMagnitude = 2;\r\n\r\n        this.onObjMoveStepBegin(obj, obj.currentTargetTile.x, obj.currentTargetTile.y);\r\n    }\r\n\r\n    stopObject(obj)  {\r\n        obj.currentPath = null;\r\n        obj.currentTarget = null;\r\n        obj.currentTargetTile = null;\r\n        this.moveEngine.removeMovable(obj);\r\n    }\r\n\r\n    onObjMoveStepBegin(obj, x, y) {\r\n        // Note that mapPos is being updated prior to movement\r\n        obj.currentDirection = getDirection(obj.gridX, obj.gridY, x, y);\r\n        obj.isMoving = true;\r\n        obj.changeVisualToDirection(obj.currentDirection);\r\n       \r\n        this.moveEngine.setMoveParameters(obj, x, y);\r\n        this.moveEngine.addMovable(obj); \r\n        return true;\r\n      \r\n    }\r\n\r\n    onObjMoveStepEnd(obj) {\r\n        obj.currentPathStep--;\r\n        obj.currentTarget = null;\r\n        obj.currentTargetTile = null;\r\n        const pathEnded = (0 > obj.currentPathStep);\r\n        this.moveEngine.removeMovable(obj);\r\n        let forceStop = false;\r\n\r\n        // 현재 지나고 있는 타일에 이벤트가 있는지 확인한다\r\n        // 하드코딩으로 이벤트를 지나게 한다\r\n        if (this.onTilePassing) {\r\n            forceStop = this.onTilePassing(obj);\r\n        }\r\n\r\n        // 만약에 인터랙티브 타겟이 있고, 길이가 하나 남았으면 정지시킨다.\r\n        if (this.interactTarget && obj.currentPathStep === 0) {\r\n            forceStop = true;\r\n        }\r\n        \r\n        if (!pathEnded && !forceStop) {\r\n            this.moveObjThrough(obj, obj.currentPath.slice(0, obj.currentPath.length-1));\r\n        }\r\n        else {\r\n            // reached to the end of the path\r\n            obj.isMoving = false;\r\n            obj.changeVisualToDirection(obj.currentDirection);\r\n\r\n            // 인터랙션 타겟이 있었나?\r\n            if (this.interactTarget) {\r\n                // 캐릭터가 해당 물체를 클릭하였다\r\n                const interactTarget = this.interactTarget;\r\n                this.interactTarget = null; // 먼저 null 로 만들어주어야 한다\r\n                if (this.onTouchObject) {\r\n                    this.onTouchObject(interactTarget);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    highlightPath(currentPath, newPath) {\r\n        if (currentPath)\r\n        {\r\n            for (let i=0; i < currentPath.length; i++)\r\n            {\r\n                const pathItem = currentPath[i];\r\n                if (!newPath || newPath.indexOf(pathItem) === -1)\r\n                {\r\n                    const tile = this.getGroundTileAt(pathItem.x, pathItem.y);\r\n                    tile.setHighlighted(false);\r\n                }\r\n            }\r\n        }\r\n        if (newPath)\r\n        {\r\n            for (let i=0; i < newPath.length; i++)\r\n            {\r\n                const pathItem = newPath[i];\r\n                if (!currentPath || currentPath.indexOf(pathItem) === -1)\r\n                {\r\n                    const tile = this.getGroundTileAt(pathItem.x, pathItem.y);\r\n                    tile.setHighlighted(true);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    checkForTileChange(obj)  {\r\n        const pos = { x: obj.position.x, y: obj.position.y };\r\n        // var tile = this.tileArray[obj.mapPos.r][obj.mapPos.c];\r\n        const tile = this.getGroundTileAt(obj.currentTargetTile.x, obj.currentTargetTile.y);\r\n        // move positions to parent scale\r\n        const vertices = [];\r\n        for (let i=0; i < tile.vertices.length; i++)\r\n        {\r\n            vertices[i] = [tile.vertices[i][0] + tile.position.x, tile.vertices[i][1] + tile.position.y];\r\n        }\r\n        \r\n        if (obj.currentTargetTile.x !== obj.gridX || obj.currentTargetTile.y !== obj.gridY)\r\n        {\r\n            if (isInPolygon(pos, vertices))\r\n            {\r\n                this.arrangeObjLocation(obj, obj.currentTargetTile.x, obj.currentTargetTile.y);\r\n                this.arrangeObjTransperancies(obj, obj.gridX, obj.gridY, obj.currentTargetTile.x, obj.currentTargetTile.y);\r\n                this.arrangeDepthsFromLocation(obj.gridX, obj.gridY);\r\n            }\r\n        }\t\r\n    }\r\n\r\n    focusBattleCenter() {\r\n        if (true) {\r\n            const px = this.externalCenter.x - this.mapVisualWidthReal / 2 * this.currentScale;\r\n            const py = this.externalCenter.y - this.mapVisualHeightReal / 20 * this.currentScale;\r\n\r\n            this.tweens.addTween(this.mapContainer.position, 0.5, { x: px, y: py }, 0, \"easeInOut\", true);\r\n        }\r\n    }\r\n\r\n    focusBattleObject(obj) {\r\n        this.currentFocusLocation = { c: obj.gridX, r: obj.gridY };\r\n        const px = this.externalCenter.x - obj.position.x * this.currentScale;\r\n        const py = this.externalCenter.y - obj.position.y * this.currentScale + 20;\r\n\r\n        setTimeout(() => {\r\n            this.tweens.addTween(this.mapContainer.position, 0.5, { x: px, y: py }, 0, \"easeInOut\", true);\r\n        }, 500)\r\n    }\r\n\r\n    checkForFollowCharacter(obj, instantFollow) {\r\n        if (true) {\r\n            this.currentFocusLocation = { c: obj.gridX, r: obj.gridY };\r\n            const px = this.externalCenter.x - obj.position.x * this.currentScale;\r\n            const py = this.externalCenter.y - obj.position.y * this.currentScale;\r\n            \r\n            if (instantFollow) {\r\n                this.mapContainer.position.x = px;\r\n                this.mapContainer.position.y = py;\r\n            } else {\r\n                this.tweens.addTween(this.mapContainer.position, 0.1, { x: px, y: py }, 0, \"easeOut_ex\", true );\r\n            }\r\n        }\r\n    }\r\n\r\n    \r\n\r\n    arrangeObjTransperancies(obj, prevX, prevY, x, y) {\r\n        if (true) {\r\n            for (let i = 0; i < this.objectMap.length; ++i) {\r\n                const a = this.objectMap[i];\r\n                if (a) {\r\n                    a.alpha = 1;\r\n                }\r\n            }\r\n\r\n            for (let j = y; j < this.mapHeight; ++j) {\r\n                for (let i = 0; i <= x; ++i) {\r\n                    const tile = this.objectMap[i + j * this.mapWidth];\r\n                    if (tile && tile !== obj) {\r\n                        // 충돌체크를 한다\r\n                        const hit = hitTestRectangle(tile.getBounds(), obj.getBounds());\r\n                        if (hit) {\r\n                            tile.alpha = 0.75;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    changeObjAlphasInLocation(value, x, y) {\r\n        const a = this.objectContainer[x + y * this.mapWidth];\r\n        if (a) {\r\n            a.alpha = value;\r\n        }\r\n    }\r\n        \r\n    arrangeObjLocation(obj, x, y) {\r\n        this.removeObjRefFromLocation(obj);\r\n        this.addObjRefToLocation(obj, x, y);\r\n    }\r\n    \r\n    arrangeDepthsFromLocation(gridX, gridY) {\r\n        for (let y = gridY; y < this.mapHeight; y++) {\r\n            for (let x = gridX - 1; x >= 0; x--) {\r\n                const a = this.objectMap[x + y * this.mapWidth];\r\n                if (a) {\r\n                    this.objectContainer.addChild(a);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    removeObjRefFromLocation(obj) {\r\n        //const index = obj.gridX + obj.gridY * this.mapWidth;\r\n        //this.objectMap[index] = null;\r\n        this.objectContainer.removeChild(obj);\r\n    }\r\n    \r\n    addObjRefToLocation(obj, x, y) {\r\n        \r\n        obj.gridX = x;\r\n        obj.gridY = y;\r\n      \r\n\r\n        //const index = x + y * this.mapWidth;\r\n        //this.objectMap[index] = obj;\r\n        this.objectContainer.addChild(obj);\r\n    }\r\n\r\n    update() {\r\n        this.moveEngine.update();\r\n        this.tweens.update();\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/stage.js","var map = {\n\t\"./assets/assets_characters.json\": \"pecr\",\n\t\"./assets/assets_characters.png\": \"ThIZ\",\n\t\"./assets/assets_map.json\": \"hZSW\",\n\t\"./assets/assets_map.png\": \"F/sg\",\n\t\"./assets/background.png\": \"cf+J\",\n\t\"./assets/battle-turn_enemy.png\": \"h9v0\",\n\t\"./assets/battle-turn_player.png\": \"kpgF\",\n\t\"./assets/border.png\": \"2OwV\",\n\t\"./assets/btn_centralize.png\": \"R2tb\",\n\t\"./assets/btn_centralizeToObject.png\": \"KKxP\",\n\t\"./assets/btn_focusToObject.png\": \"/Um0\",\n\t\"./assets/btn_zoomIn.png\": \"bxyk\",\n\t\"./assets/btn_zoomOut.png\": \"A2HH\",\n\t\"./assets/ch01_skill01.png\": \"ixNQ\",\n\t\"./assets/ch01_skill01_on.png\": \"n0x2\",\n\t\"./assets/ch01_skill02.png\": \"1CaR\",\n\t\"./assets/ch01_skill02_on.png\": \"Thq4\",\n\t\"./assets/ch02_skill01.png\": \"wCSF\",\n\t\"./assets/ch02_skill01_on.png\": \"lIDM\",\n\t\"./assets/ch02_skill02.png\": \"1BTM\",\n\t\"./assets/ch02_skill02_on.png\": \"683H\",\n\t\"./assets/ch03_skill01.png\": \"RWdx\",\n\t\"./assets/ch03_skill01_on.png\": \"vDF+\",\n\t\"./assets/ch03_skill02.png\": \"6QCc\",\n\t\"./assets/ch03_skill02_on.png\": \"xnvo\",\n\t\"./assets/combine.png\": \"61+0\",\n\t\"./assets/combine_button.png\": \"d9pj\",\n\t\"./assets/combine_listitem.png\": \"SJkF\",\n\t\"./assets/dialog.png\": \"QKlM\",\n\t\"./assets/dialogtitle.png\": \"yDv2\",\n\t\"./assets/elid/elid_atk_nw.json\": \"vbJk\",\n\t\"./assets/elid/elid_atk_nw.png\": \"7rqt\",\n\t\"./assets/elid/elid_atk_sw.json\": \"hMIW\",\n\t\"./assets/elid/elid_atk_sw.png\": \"/YY/\",\n\t\"./assets/elid/elid_death_nw.png\": \"v5Cq\",\n\t\"./assets/elid/elid_idle_nw.json\": \"6S6p\",\n\t\"./assets/elid/elid_idle_nw.png\": \"W/RV\",\n\t\"./assets/elid/elid_idle_sw.json\": \"rki7\",\n\t\"./assets/elid/elid_idle_sw.png\": \"daie\",\n\t\"./assets/ending.png\": \"QSXp\",\n\t\"./assets/ending_victory.png\": \"1qmm\",\n\t\"./assets/groundImage.jpg\": \"62uW\",\n\t\"./assets/highlight.png\": \"0aEm\",\n\t\"./assets/inventory.png\": \"S0Ft\",\n\t\"./assets/items/item3.png\": \"r15H\",\n\t\"./assets/mapdata/map.json\": \"ilsi\",\n\t\"./assets/mapdata/map2.json\": \"QyYQ\",\n\t\"./assets/mapdata/map3.json\": \"0SKj\",\n\t\"./assets/mapdata/objects.json\": \"bcYj\",\n\t\"./assets/mapdata/objects.png\": \"XvEF\",\n\t\"./assets/mapdata/stealBar.png\": \"J808\",\n\t\"./assets/mapdata/stealBarL.png\": \"On9J\",\n\t\"./assets/mapdata/stealBarR.png\": \"ob3r\",\n\t\"./assets/mapdata/tiles.json\": \"pwQP\",\n\t\"./assets/mapdata/tiles.png\": \"xGYh\",\n\t\"./assets/mapdata/walls.json\": \"/qV/\",\n\t\"./assets/mapdata/walls.png\": \"1c7l\",\n\t\"./assets/medusa/monster1-atk_sw.json\": \"UOdx\",\n\t\"./assets/medusa/monster1-atk_sw.png\": \"kQwz\",\n\t\"./assets/medusa/monster1_idle_sw.json\": \"vW6P\",\n\t\"./assets/medusa/monster1_idle_sw.png\": \"y7rX\",\n\t\"./assets/miluda/miluda_atk_nw.json\": \"O5rI\",\n\t\"./assets/miluda/miluda_atk_nw.png\": \"I3+a\",\n\t\"./assets/miluda/miluda_atk_sw.json\": \"/HZx\",\n\t\"./assets/miluda/miluda_atk_sw.png\": \"O4gy\",\n\t\"./assets/miluda/miluda_idle_nw.json\": \"pjYb\",\n\t\"./assets/miluda/miluda_idle_nw.png\": \"imdM\",\n\t\"./assets/miluda/miluda_idle_sw.json\": \"Mygw\",\n\t\"./assets/miluda/miluda_idle_sw.png\": \"mmyy\",\n\t\"./assets/monster01.png\": \"3AXL\",\n\t\"./assets/monster01_active.png\": \"LSkp\",\n\t\"./assets/monster02.png\": \"ZHXx\",\n\t\"./assets/monster02_active.png\": \"Lb+B\",\n\t\"./assets/monster03.png\": \"iIlD\",\n\t\"./assets/monster03_active.png\": \"5J8E\",\n\t\"./assets/night/atk_nw.json\": \"4C0C\",\n\t\"./assets/night/atk_nw.png\": \"AJu8\",\n\t\"./assets/night/atk_sw.json\": \"xykr\",\n\t\"./assets/night/atk_sw.png\": \"4GjZ\",\n\t\"./assets/night/idle_nw.json\": \"zPL7\",\n\t\"./assets/night/idle_nw.png\": \"/wL9\",\n\t\"./assets/night/idle_sw.json\": \"egTb\",\n\t\"./assets/night/idle_sw.png\": \"EEAh\",\n\t\"./assets/night/sword_nw.json\": \"v8ZX\",\n\t\"./assets/night/sword_nw.png\": \"vIzp\",\n\t\"./assets/night/sword_sw.json\": \"IQyG\",\n\t\"./assets/night/sword_sw.png\": \"S6X1\",\n\t\"./assets/night/walk_nw.json\": \"PDkE\",\n\t\"./assets/night/walk_nw.png\": \"i6JU\",\n\t\"./assets/night/walk_sw.json\": \"co/e\",\n\t\"./assets/night/walk_sw.png\": \"QRr6\",\n\t\"./assets/opening.png\": \"tSQQ\",\n\t\"./assets/pbar.png\": \"SE36\",\n\t\"./assets/pbar_g.png\": \"ExSd\",\n\t\"./assets/pbar_o.png\": \"L1gO\",\n\t\"./assets/pbar_r.png\": \"Azkk\",\n\t\"./assets/player1.png\": \"TCQi\",\n\t\"./assets/player1_active.png\": \"FiEM\",\n\t\"./assets/player1_active2.png\": \"ufHM\",\n\t\"./assets/player2.png\": \"2aNe\",\n\t\"./assets/player2_active.png\": \"PHls\",\n\t\"./assets/player2_active2.png\": \"uGjp\",\n\t\"./assets/player3.png\": \"SPZO\",\n\t\"./assets/player3_active.png\": \"m4/X\",\n\t\"./assets/player3_active2.png\": \"sskf\",\n\t\"./assets/shadow.png\": \"z8NX\",\n\t\"./assets/slash_1.json\": \"7jKW\",\n\t\"./assets/slash_1.png\": \"QJA4\",\n\t\"./assets/statui.png\": \"JqAh\",\n\t\"./assets/theater.png\": \"qTO+\",\n\t\"./assets/titan/monster2-atk_sw.json\": \"nqSm\",\n\t\"./assets/titan/monster2-atk_sw.png\": \"uCLC\",\n\t\"./assets/titan/monster2-idle_sw.json\": \"B2Me\",\n\t\"./assets/titan/monster2-idle_sw.png\": \"3U4P\",\n\t\"./assets/torch_light.png\": \"sARW\",\n\t\"./assets/ui/chatballon.png\": \"mm+o\",\n\t\"./assets/ui/chatballon_comma.png\": \"aPgd\",\n\t\"./assets/window_light.png\": \"AkAU\",\n\t\"./assets/windowlight.png\": \"x0Wi\",\n\t\"./js/battle\": \"m5GK\",\n\t\"./js/battle.js\": \"m5GK\",\n\t\"./js/character\": \"zTqn\",\n\t\"./js/character.js\": \"zTqn\",\n\t\"./js/define\": \"DkLz\",\n\t\"./js/define.js\": \"DkLz\",\n\t\"./js/explore\": \"p4ax\",\n\t\"./js/explore.js\": \"p4ax\",\n\t\"./js/game\": \"c6m3\",\n\t\"./js/game.js\": \"c6m3\",\n\t\"./js/moveengine\": \"PxTa\",\n\t\"./js/moveengine.js\": \"PxTa\",\n\t\"./js/movieclip\": \"OSyj\",\n\t\"./js/movieclip.js\": \"OSyj\",\n\t\"./js/pathfinder\": \"GoZD\",\n\t\"./js/pathfinder.js\": \"GoZD\",\n\t\"./js/player\": \"1fqz\",\n\t\"./js/player.js\": \"1fqz\",\n\t\"./js/resource-manager\": \"YxTU\",\n\t\"./js/resource-manager.js\": \"YxTU\",\n\t\"./js/stage\": \"+0Jn\",\n\t\"./js/stage.js\": \"+0Jn\",\n\t\"./js/tile\": \"V6BF\",\n\t\"./js/tile.js\": \"V6BF\",\n\t\"./js/tweens\": \"2Pg/\",\n\t\"./js/tweens.js\": \"2Pg/\",\n\t\"./js/ui\": \"qOui\",\n\t\"./js/ui.js\": \"qOui\",\n\t\"./main\": \"NHnr\",\n\t\"./main.js\": \"NHnr\"\n};\nfunction webpackContext(req) {\n\treturn __webpack_require__(webpackContextResolve(req));\n};\nfunction webpackContextResolve(req) {\n\tvar id = map[req];\n\tif(!(id + 1)) // check for number or string\n\t\tthrow new Error(\"Cannot find module '\" + req + \"'.\");\n\treturn id;\n};\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = \"+gN6\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src ^\\.\\/.*$\n// module id = +gN6\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/miluda/miluda_atk_sw.json\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/miluda/miluda_atk_sw.json\n// module id = /HZx\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/btn_focusToObject.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/btn_focusToObject.png\n// module id = /Um0\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/elid/elid_atk_sw.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/elid/elid_atk_sw.png\n// module id = /YY/\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/mapdata/walls.json\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/mapdata/walls.json\n// module id = /qV/\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/night/idle_nw.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/night/idle_nw.png\n// module id = /wL9\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/mapdata/map3.json\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/mapdata/map3.json\n// module id = 0SKj\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/highlight.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/highlight.png\n// module id = 0aEm\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/ch02_skill02.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/ch02_skill02.png\n// module id = 1BTM\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/ch01_skill02.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/ch01_skill02.png\n// module id = 1CaR\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/mapdata/walls.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/mapdata/walls.png\n// module id = 1c7l\n// module chunks = 1","import Character from './character';\n\nfunction loadAniTexture(name, count) {\n    const frames = [];  \n    for (let i = 0; i < count; i++) {\n        frames.push(PIXI.Texture.fromFrame(name + i + '.png'));\n    }\n    return frames;\n}\n\n\n// 얘네 다른곳으로 빼야할 듯 하다..\nclass Knight extends Character {\n    constructor() {\n        super();\n        this.removeChild(this.container);\n\n        // 스프라이트 로드같은것 캐릭터마다 다를테고.. 초상화 같은것도 있을테고.. 음 \n        this.name = \"Hector\";\n\n        // Battle UI\n        this.portrait = new PIXI.Sprite(PIXI.Texture.fromFrame(\"player1_active.png\"));\n        this.skillAIcon = new PIXI.Sprite(PIXI.Texture.fromFrame(\"ch03_skill01_on.png\"));\n        this.skillBIcon = new PIXI.Sprite(PIXI.Texture.fromFrame(\"ch03_skill02.png\"));\n\n        // Stat\n        this.hp = 300;\n        this.maxHp = 300;\n        this.damage = 120;\n        this.balance = 0.85;\n        this.ciriticalRate = 0.3;\n        this.ciriticalBalance = 1.7;\n        this.defense = 0.5;\n        \n        // Animation\n        this.animations.idle_nw = { textures: loadAniTexture(\"idle_nw\", 2), flipX: false };\n        this.animations.idle_sw = { textures: loadAniTexture(\"idle_sw\", 2), flipX: false };\n        this.animations.idle_ne = { textures: this.animations.idle_nw.textures, flipX: true };\n        this.animations.idle_se = { textures: this.animations.idle_sw.textures, flipX: true };\n\n        this.animations.walk_nw = { textures: loadAniTexture(\"walk_nw\", 8), flipX: false };\n        this.animations.walk_sw = { textures: loadAniTexture(\"walk_sw\", 8), flipX: false };\n        this.animations.walk_ne = { textures: this.animations.walk_nw.textures, flipX: true };\n        this.animations.walk_se = { textures: this.animations.walk_sw.textures, flipX: true };\n\n        this.animations.attack_nw = { textures: loadAniTexture(\"atk_nw\", 10), flipX: false };\n        this.animations.attack_sw = { textures: loadAniTexture(\"atk_sw\", 10), flipX: false };\n        this.animations.attack_ne = { textures: this.animations.attack_nw.textures, flipX: true };\n        this.animations.attack_se = { textures: this.animations.attack_sw.textures, flipX: true };\n\n        const anim = new PIXI.extras.AnimatedSprite(this.animations.idle_sw.textures);\n        anim.animationSpeed = 0.1;\n        anim.play();\n        anim.position.y = -48; // 하드코딩\n        this.anim = anim;\n        this.container.addChild(anim);\n\n        // 하드코딩\n        this.hpHolder.position.y = -this.anim.height - 8;\n        this.hpHolder.position.x = 16 - this.hpHolder.width / 2;\n        this.hpBar.position.y = -this.anim.height - 7;\n        this.hpBar.position.x = 16 - this.hpHolder.width / 2 + 1;\n        \n        this.addChild(this.container);\n    }\n}\n\nexport default class Player extends Knight {\n    constructor() {\n        super();\n\n        this.inventory = new Inventory();\n    }\n}\n\nclass Inventory {\n    constructor() {\n        this.items = [];\n    }\n\n    addItem(itemId, itemType) {\n        const item = new Item(itemId, itemType);\n        this.items.push(item);\n    }\n\n    getItemByType(itemType) {\n        for(const item of this.items) {\n            if (item.itemType === itemType) {\n                return item;\n            }\n        }\n        return null;\n    }\n\n    deleteItem(itemId) {\n        for (let i = 0; i < this.items.length; i++) {\n            const item = this.items[i];\n            if (item.itemId === itemId) {\n                this.items.splice(i, 1);\n                return;\n            }\n        }\n    }\n\n    eachItem(callback) {\n        for(const item of this.items) {\n            callback(item);\n        }\n    }\n}\n\nclass Item {\n    constructor(itemId, itemType) {\n        this.itemId = itemId;\n        this.itemType = itemType;\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/player.js","module.exports = __webpack_public_path__ + \"src/assets/ending_victory.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/ending_victory.png\n// module id = 1qmm\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/border.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/border.png\n// module id = 2OwV\n// module chunks = 1","const linearTween = function (t, b, c, d) {\r\n    return c*t/d + b;\r\n};\r\nconst easeInQuad = function (t, b, c, d) {\r\n    t /= d;\r\n    return c*t*t + b;\r\n};\r\nconst easeOutQuad = function (t, b, c, d) {\r\n    t /= d;\r\n    return -c * t*(t-2) + b;\r\n};\r\nconst easeOutQuad_ex = function (t, b, c, d) {\r\n    t /= d;\r\n    return Math.floor(-c * t*(t-2) + b);\r\n};\r\nconst easeInOutQuad = function (t, b, c, d) {\r\n    t /= d/2;\r\n    if (t < 1) { return c/2*t*t + b; }\r\n    t--;\r\n    return -c/2 * (t*(t-2) - 1) + b;\r\n};\r\n\r\nconst getEasingFunc = function (e) {\r\n    if (e === \"easeInOut\" || e === \"easeInOutQuad\" || e === \"Quad.easeInOut\")\r\n    {\r\n        return easeInOutQuad;\r\n    }\r\n    else if (e === \"easeIn\" || e === \"easeInQuad\" || e === \"Quad.easeIn\")\r\n    {\r\n        return easeInQuad;\r\n    }\r\n    else if (e === \"easeOut\" || e === \"easeOutQuad\" || e === \"Quad.easeOut\")\r\n    {\r\n        return easeOutQuad;\r\n    }\r\n    else if (e === \"easeOut_ex\") {\r\n        return easeOutQuad_ex;\r\n    }\r\n    else\r\n    {\r\n        return linearTween;\r\n    }\r\n};\r\n\r\nexport default class Tweens {\r\n    constructor() {\r\n        this.activeForTweens = false;\r\n        this.processFrame = true;\r\n        this.tweenTargets = [];\r\n        this.fps = 60;\r\n    }\r\n\r\n    addTween(o, duration, vars, delay, easing, overwrite, onComplete) {\r\n        let v = null;\r\n        for (const prop in vars) {\r\n            if (!v) { v = {}; }\r\n            v[prop] = { b: o[prop], c: vars[prop] - o[prop] };\r\n        }\r\n        \r\n        if (v) {\r\n            const t = {\r\n                target : \t\to,\r\n                duration : \t\tduration,\r\n                easingFunc : \tgetEasingFunc(easing),\r\n                overwrite : \toverwrite || false,\r\n                onComplete : \tonComplete || null,\r\n                totalFrames : \tduration * this.fps,\r\n                delayFrame:     delay * this.fps,\r\n                currentFrame : \t0,\r\n                vars : \t\t\tv\r\n            };\r\n                    \r\n            const idx = this.tweenTargets.indexOf(o); \r\n            if (idx >= 0) {\r\n                let tweens = o.tweens;\r\n                if (!tweens) {\r\n                    tweens = [];\r\n                }\r\n                if (t.overwrite) {\r\n                    for (let i=0; i < tweens.length; i++) {\r\n                        tweens[i] = null;\r\n                    }\r\n                    tweens = [];\r\n                }\r\n                \r\n                tweens[tweens.length] = t;\r\n                o.tweens = tweens;\r\n            } else {\r\n                o.tweens = [t];\r\n                this.tweenTargets[this.tweenTargets.length] = o;\r\n            }\r\n\r\n            if (this.tweenTargets.length > 0 && !this.activeForTweens) {\r\n                this.activeForTweens = true;\r\n            }\r\n        }\r\n    }\r\n\r\n    removeTween(o, t) {\r\n        let targetRemoved = false;\r\n        \r\n        if (o && t) {\r\n            const idx = this.tweenTargets.indexOf(o); \r\n            if (idx >= 0) {\r\n                if (this.tweenTargets[idx].tweens && this.tweenTargets[idx].tweens.length > 0) {\r\n                    const tweens = this.tweenTargets[idx].tweens;\r\n                    const idx2 = tweens.indexOf(t);\r\n                    if (idx2 >= 0) {\r\n                        t.onComplete = null;\r\n                        t.easingFunc = null;\r\n                        t.target = null;\r\n                        \r\n                        tweens.splice(idx2, 1);\r\n                        if (tweens.length === 0) {\r\n                            this.tweenTargets.splice(idx, 1);\r\n                            targetRemoved = true;\r\n                        }\r\n                    } else {\r\n                        console.log(o, t);\r\n                        throw new Error(\"No tween defined for this object\");\r\n                    }\r\n                } else {\r\n                    throw new Error(\"No tween defined for this object\");\r\n                }\r\n            } else {\r\n                throw new Error(\"No tween target defined for this object\");\r\n            }\r\n            \r\n            if (this.tweenTargets.length === 0) {\r\n                this.activeForTweens = false;\r\n            }\r\n        }\r\n        \r\n        return targetRemoved;\r\n    }\r\n\r\n    update() {\r\n        if (this.activeForTweens) {\r\n            // and a loop for tween animations\r\n            let len = this.tweenTargets.length;\r\n            for (let i=0; i < len; i++)\r\n            {\r\n                const o = this.tweenTargets[i];\r\n                const tweens = o.tweens;\r\n                for (let j=0; j < tweens.length; j++)\r\n                {\r\n                    const t = tweens[j];\r\n                    t.currentFrame++;\r\n                    if (t.currentFrame >= t.delayFrame) {\r\n                        const vars = t.vars;\r\n                        for (const prop in vars)\r\n                        {\r\n                            o[prop] = t.easingFunc(t.currentFrame - t.delayFrame, vars[prop].b, vars[prop].c, t.totalFrames);\r\n                        }\r\n                        \r\n                        if (t.currentFrame - t.delayFrame >= t.totalFrames) {\r\n                            const onComplete = t.onComplete;\r\n                            if (this.removeTween(o, t)) {\r\n                                i--; len--;\r\n                            }\r\n                            j--;\r\n\r\n                            if (onComplete) { onComplete(); }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/tweens.js","module.exports = __webpack_public_path__ + \"src/assets/player2.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/player2.png\n// module id = 2aNe\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/monster01.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/monster01.png\n// module id = 3AXL\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/titan/monster2-idle_sw.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/titan/monster2-idle_sw.png\n// module id = 3U4P\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/night/atk_nw.json\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/night/atk_nw.json\n// module id = 4C0C\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/night/atk_sw.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/night/atk_sw.png\n// module id = 4GjZ\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/monster03_active.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/monster03_active.png\n// module id = 5J8E\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/combine.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/combine.png\n// module id = 61+0\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/groundImage.jpg\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/groundImage.jpg\n// module id = 62uW\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/ch02_skill02_on.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/ch02_skill02_on.png\n// module id = 683H\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/ch03_skill02.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/ch03_skill02.png\n// module id = 6QCc\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/elid/elid_idle_nw.json\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/elid/elid_idle_nw.json\n// module id = 6S6p\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/slash_1.json\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/slash_1.json\n// module id = 7jKW\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/elid/elid_atk_nw.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/elid/elid_atk_nw.png\n// module id = 7rqt\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/btn_zoomOut.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/btn_zoomOut.png\n// module id = A2HH\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/night/atk_nw.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/night/atk_nw.png\n// module id = AJu8\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/window_light.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/window_light.png\n// module id = AkAU\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/pbar_r.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/pbar_r.png\n// module id = Azkk\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/titan/monster2-idle_sw.json\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/titan/monster2-idle_sw.json\n// module id = B2Me\n// module chunks = 1","export const DIRECTIONS = { \r\n    SW: 2,\r\n    NW: 4,\r\n    NE: 6,\r\n    SE: 8\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/js/define.js","module.exports = __webpack_public_path__ + \"src/assets/night/idle_sw.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/night/idle_sw.png\n// module id = EEAh\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/pbar_g.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/pbar_g.png\n// module id = ExSd\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/assets_map.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/assets_map.png\n// module id = F/sg\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/player1_active.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/player1_active.png\n// module id = FiEM\n// module chunks = 1","class GridNode {\r\n    constructor(x, y, weight) {\r\n        this.x = x;\r\n        this.y = y;\r\n        this.weight = weight;\r\n        this.ignoreCollide = false;\r\n    }\r\n\r\n    getCost(fromNeighbor) {\r\n        // Take diagonal weight into consideration.\r\n        if (fromNeighbor && fromNeighbor.x !== this.x && fromNeighbor.y !== this.y)\r\n        {\r\n            return this.weight * 1.41421;\r\n        }\r\n        return this.weight;\r\n    }\r\n\r\n    isWall() {\r\n        if (this.ignoreCollide) {\r\n            return false;\r\n        } else {\r\n            return this.weight === 0 || this.dynamicWeight === 0 ;\r\n        }\r\n    }\r\n}\r\n\r\nclass BinaryHeap{\r\n    constructor(scoreFunction) {\r\n        this.content = [];\r\n        this.scoreFunction = scoreFunction;\r\n    }\r\n\r\n    push(element) {\r\n        // Add the new element to the end of the array.\r\n        this.content.push(element);\r\n\r\n        // Allow it to sink down.\r\n        this.sinkDown(this.content.length - 1);\r\n    }\r\n\r\n    pop() {\r\n        // Store the first element so we can return it later.\r\n        const result = this.content[0];\r\n        // Get the element at the end of the array.\r\n        const end = this.content.pop();\r\n        // If there are any elements left, put the end element at the\r\n        // start, and let it bubble up.\r\n        if (this.content.length > 0) {\r\n            this.content[0] = end;\r\n            this.bubbleUp(0);\r\n        }\r\n        return result;\r\n    }\r\n\r\n    remove(node) {\r\n        const i = this.content.indexOf(node);\r\n\r\n        // When it is found, the process seen in 'pop' is repeated\r\n        // to fill up the hole.\r\n        const end = this.content.pop();\r\n\r\n        if (i !== this.content.length - 1) {\r\n            this.content[i] = end;\r\n\r\n            if (this.scoreFunction(end) < this.scoreFunction(node)) {\r\n                this.sinkDown(i);\r\n            }\r\n            else {\r\n                this.bubbleUp(i);\r\n            }\r\n        }\r\n    }\r\n\r\n    size() {\r\n        return this.content.length;\r\n    }\r\n\r\n    rescoreElement(node) {\r\n        this.sinkDown(this.content.indexOf(node));\r\n    }\r\n\r\n    sinkDown(n) {\r\n        // Fetch the element that has to be sunk.\r\n        const element = this.content[n];\r\n\r\n        // When at 0, an element can not sink any further.\r\n        while (n > 0) {\r\n\r\n            // Compute the parent element's index, and fetch it.\r\n            const parentN = ((n + 1) >> 1) - 1,\r\n                parent = this.content[parentN];\r\n            // Swap the elements if the parent is greater.\r\n            if (this.scoreFunction(element) < this.scoreFunction(parent)) {\r\n                this.content[parentN] = element;\r\n                this.content[n] = parent;\r\n                // Update 'n' to continue at the new position.\r\n                n = parentN;\r\n            }\r\n            // Found a parent that is less, no need to sink any further.\r\n            else {\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    bubbleUp(n) {\r\n        // Look up the target element and its score.\r\n        const length = this.content.length,\r\n            element = this.content[n],\r\n            elemScore = this.scoreFunction(element);\r\n\r\n        while(true) {\r\n            // Compute the indices of the child elements.\r\n            const child2N = (n + 1) << 1,\r\n                child1N = child2N - 1;\r\n            // This is used to store the new position of the element, if any.\r\n            let swap = null,\r\n                child1Score;\r\n            // If the first child exists (is inside the array)...\r\n            if (child1N < length) {\r\n                // Look it up and compute its score.\r\n                const child1 = this.content[child1N];\r\n                child1Score = this.scoreFunction(child1);\r\n\r\n                // If the score is less than our element's, we need to swap.\r\n                if (child1Score < elemScore){\r\n                    swap = child1N;\r\n                }\r\n            }\r\n\r\n            // Do the same checks for the other child.\r\n            if (child2N < length) {\r\n                const child2 = this.content[child2N],\r\n                    child2Score = this.scoreFunction(child2);\r\n                if (child2Score < (swap === null ? elemScore : child1Score)) {\r\n                    swap = child2N;\r\n                }\r\n            }\r\n\r\n            // If the element needs to be moved, swap it, and continue.\r\n            if (swap !== null) {\r\n                this.content[n] = this.content[swap];\r\n                this.content[swap] = element;\r\n                n = swap;\r\n            }\r\n            // Otherwise, we are done.\r\n            else {\r\n                break;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nexport default class PathFinder {\r\n    constructor(width, height) {\r\n        \r\n        this.nodes = [];\r\n        this.grid = [];\r\n        for (let y = 0; y < height; y++)\r\n        {\r\n            this.grid.push([]);\r\n\r\n            for (let x = 0; x < width; x++)\r\n            {\r\n                const node = new GridNode(x, y, 1);\r\n                this.grid[y].push(node);\r\n                this.nodes.push(node);\r\n            }\r\n        }\r\n    }\r\n\r\n    init() {\r\n        this.dirtyNodes = [];\r\n        for (let i = 0; i < this.nodes.length; i++)\r\n        {\r\n            this.cleanNode(this.nodes[i]);\r\n        }\r\n    }\r\n\r\n    cleanNode(node) {\r\n        node.f = 0;\r\n        node.g = 0;\r\n        node.h = 0;\r\n        node.visited = false;\r\n        node.closed = false;\r\n        node.parent = null;\r\n    }\r\n\r\n    solve(originX, originY, destX, destY, ignoreTarget) {\r\n        const start = this.grid[originY][originX];\r\n        const end = this.grid[destY][destX];\r\n\r\n        end.ignoreCollide = ignoreTarget;\r\n        const result = this.search(start, end);\r\n        end.ignoreCollide = false;\r\n        \r\n        return result && result.length > 0 ? result : null;\r\n    }\r\n\r\n    search(start, end) {\r\n        this.init();\r\n        const heuristic = (pos0, pos1) => {\r\n            const d1 = Math.abs(pos1.x - pos0.x);\r\n            const d2 = Math.abs(pos1.y - pos0.y);\r\n            return d1 + d2;\r\n        };\r\n\r\n        const openHeap = new BinaryHeap((node) => node.f);\r\n\r\n        let closestNode = start; // set the start node to be the closest if required\r\n        start.h = heuristic(start, end);\r\n        openHeap.push(start);\r\n        \r\n        while(openHeap.size() > 0) {\r\n\r\n            // Grab the lowest f(x) to process next.  Heap keeps this sorted for us.\r\n            const currentNode = openHeap.pop();\r\n\r\n            // End case -- result has been found, return the traced path.\r\n            if(currentNode === end) {\r\n                return this.pathTo(currentNode);\r\n            }\r\n\r\n            // Normal case -- move currentNode from open to closed, process each of its neighbors.\r\n            currentNode.closed = true;\r\n\r\n            // Find all neighbors for the current node.\r\n            const neighbors = this.neighbors(currentNode);\r\n\r\n            for (let i = 0, il = neighbors.length; i < il; ++i) {\r\n                const neighbor = neighbors[i];\r\n\r\n                if (neighbor.closed || neighbor.isWall()) {\r\n                    // Not a valid node to process, skip to next neighbor.\r\n                    continue;\r\n                }\r\n\r\n                // The g score is the shortest distance from start to current node.\r\n                // We need to check if the path we have arrived at this neighbor is the shortest one we have seen yet.\r\n                const gScore = currentNode.g + neighbor.getCost(currentNode);\r\n                const beenVisited = neighbor.visited;\r\n\r\n                if (!beenVisited || gScore < neighbor.g) {\r\n\r\n                    // Found an optimal (so far) path to this node.  Take score for node to see how good it is.\r\n                    neighbor.visited = true;\r\n                    neighbor.parent = currentNode;\r\n                    neighbor.h = neighbor.h || heuristic(neighbor, end);\r\n                    neighbor.g = gScore;\r\n                    neighbor.f = neighbor.g + neighbor.h;\r\n                    this.markDirty(neighbor);\r\n                   \r\n                    // If the neighbour is closer than the current closestNode or if it's equally close but has\r\n                    // a cheaper path than the current closest node then it becomes the closest node\r\n                    if (neighbor.h < closestNode.h || (neighbor.h === closestNode.h && neighbor.g < closestNode.g)) {\r\n                        closestNode = neighbor;\r\n                    }\r\n\r\n                    if (!beenVisited) {\r\n                        // Pushing to heap will put it in proper place based on the 'f' value.\r\n                        openHeap.push(neighbor);\r\n                    }\r\n                    else {\r\n                        // Already seen the node, but since it has been rescored we need to reorder it in the heap\r\n                        openHeap.rescoreElement(neighbor);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return this.pathTo(closestNode);\r\n    }\r\n\r\n    pathTo(node) {\r\n        let curr = node;\r\n        const path = [];\r\n        while(curr.parent) {\r\n            path.push(curr);\r\n            curr = curr.parent;\r\n        }\r\n        // return path.reverse();\r\n        return path;\r\n    }\r\n\r\n    neighbors(node) {\r\n        const ret = [],\r\n            y = node.x,\r\n            x = node.y,\r\n            grid = this.grid;\r\n\r\n        // West\r\n        if(grid[x-1] && grid[x-1][y]) {\r\n            ret.push(grid[x-1][y]);\r\n        }\r\n\r\n        // East\r\n        if(grid[x+1] && grid[x+1][y]) {\r\n            ret.push(grid[x+1][y]);\r\n        }\r\n\r\n        // South\r\n        if(grid[x] && grid[x][y-1]) {\r\n            ret.push(grid[x][y-1]);\r\n        }\r\n\r\n        // North\r\n        if(grid[x] && grid[x][y+1]) {\r\n            ret.push(grid[x][y+1]);\r\n        }\r\n\r\n\r\n        return ret;\r\n    }\r\n\r\n    markDirty(node) {\r\n        this.dirtyNodes.push(node);\r\n    }\r\n\r\n    setCell(x, y, movable) {\r\n\t    this.grid[y][x].weight = movable ? 1 : 0;\r\n    }\r\n\r\n    setDynamicCell(x, y, movable) {\r\n        this.grid[y][x].dynamicWeight = movable ? 1 : 0;\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/pathfinder.js","module.exports = __webpack_public_path__ + \"src/assets/miluda/miluda_atk_nw.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/miluda/miluda_atk_nw.png\n// module id = I3+a\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/night/sword_sw.json\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/night/sword_sw.json\n// module id = IQyG\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/mapdata/stealBar.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/mapdata/stealBar.png\n// module id = J808\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/statui.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/statui.png\n// module id = JqAh\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/btn_centralizeToObject.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/btn_centralizeToObject.png\n// module id = KKxP\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/pbar_o.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/pbar_o.png\n// module id = L1gO\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/monster01_active.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/monster01_active.png\n// module id = LSkp\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/monster02_active.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/monster02_active.png\n// module id = Lb+B\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/miluda/miluda_idle_sw.json\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/miluda/miluda_idle_sw.json\n// module id = Mygw\n// module chunks = 1","import Game from './js/game'\nimport UI from './js/ui'\nimport ResourceManager from './js/resource-manager'\n\nfunction initApp() {\n  const pixi = new PIXI.Application(980, 500  , { backgroundColor : 0x6BACDE, forceCanvas: true });\n  document.body.appendChild(pixi.view);\n\n  // 오프닝을 준비한다\n  const loader = new ResourceManager();\n\n  loader.add('opening.png', 'assets/opening.png');\n  loader.add('border.png', 'assets/border.png');\n  loader.load(() => {\n      // 화면을 그린다\n      // 버튼을 클릭하면 게임을 시작한다\n      const sprite = new PIXI.Sprite(PIXI.Texture.fromFrame('opening.png'))\n      sprite.interactive = true;\n      pixi.stage.addChild(sprite);\n      sprite.mouseup = () => {\n          gameStart(pixi);\n      };\n\n      pixi.stage.addChild(new PIXI.Sprite(PIXI.Texture.fromFrame(\"border.png\")));\n  });\n}\n\n\nfunction gameStart(pixi) {\n  // 나중에 스테이지 데이터와 캐릭터 데이터를 자동으로 추출할수 있게 해야한다\n  // 로딩 속도를 최적화 하기 위해서\n  // 일단은 모든 데이터를 다 넣도록 하자 (알아서 캐싱된다)\n\n  pixi.stage.removeChildren();\n  const game = new Game(pixi);\n  pixi.stage.addChild(new PIXI.Sprite(PIXI.Texture.fromFrame(\"border.png\")));\n\n  game.resourceManager.add(\"dialog.png\", \"assets/dialog.png\");\n  game.resourceManager.add(\"dialogtitle.png\", \"assets/dialogtitle.png\");\n  game.resourceManager.add(\"theater.png\", \"assets/theater.png\");\n  game.resourceManager.add(\"item3.png\", \"assets/items/item3.png\");\n  game.resourceManager.add(\"chatballon.png\", \"assets/ui/chatballon.png\");\n  game.resourceManager.add(\"chatballon_comma.png\", \"assets/ui/chatballon_comma.png\");\n  game.resourceManager.add(\"ending.png\", \"assets/ending.png\");\n  game.resourceManager.add(\"inventory.png\", \"assets/inventory.png\");\n  game.resourceManager.add(\"combine.png\", \"assets/combine.png\");\n  game.resourceManager.add(\"combine_listitem.png\", \"assets/combine_listitem.png\");\n  game.resourceManager.add(\"combine_button.png\", \"assets/combine_button.png\");\n  game.resourceManager.add(\"player1_active.png\",\"assets/player1_active.png\");\n  game.resourceManager.add(\"player2_active.png\", \"assets/player2_active.png\");\n  game.resourceManager.add(\"player3_active.png\", \"assets/player3_active.png\");\n  game.resourceManager.add(\"ch01_skill01_on.png\", \"assets/ch01_skill01_on.png\");\n  game.resourceManager.add(\"ch01_skill02.png\", \"assets/ch01_skill02.png\");\n  game.resourceManager.add(\"ch02_skill01_on.png\", \"assets/ch02_skill01_on.png\");\n  game.resourceManager.add(\"ch02_skill02.png\", \"assets/ch02_skill02.png\");\n  game.resourceManager.add(\"ch03_skill01_on.png\", \"assets/ch03_skill01_on.png\");\n  game.resourceManager.add(\"ch03_skill02.png\", \"assets/ch03_skill02.png\");\n  game.resourceManager.add(\"monster01_active.png\", \"assets/monster01_active.png\");\n  game.resourceManager.add(\"monster02_active.png\", \"assets/monster02_active.png\");\n  game.resourceManager.add(\"monster03_active.png\", \"assets/monster03_active.png\");\n  game.resourceManager.add(\"ending_victory.png\", \"assets/ending_victory.png\");\n\n  game.resourceManager.load(() => {\n      const ui = new UI(game);\n      game.ui = ui;\n\n      game.start({ stagePath: 'assets/mapdata/map.json' });\n      const game_update = () => {\n          game.update();\n          ui.update();\n          requestAnimationFrame(game_update);\n      }\n      game_update();\n\n\n      let toggle = true;\n\n      window.addEventListener(\"keydown\", (e) => {\n          if (e.keyCode === 66) {\n              // 스테이지를 변경한다\n              toggle = !toggle;\n              if (toggle) {\n                  game.enterStage('assets/mapdata/map.json', \"explore\");\n              } else {\n                  game.enterStage('assets/mapdata/map2.json', \"battle\");\n              }\n          } else if (e.keyCode  === 67) {\n              //ui.showDialog(\"테스트 다이얼로그입니다. 클릭하면 꺼집니다\");\n              //ui.showItemAcquire();\n              //ui.showChatBallon(game.player, \"테스트\");\n              if (toggle) {\n                  ui.showCombine();\n              } else {\n                  ui.hideCombine();\n              }\n              toggle = !toggle;\n          } \n      }, true);\n  });\n}\n\ninitApp();\n\n\n// WEBPACK FOOTER //\n// ./src/main.js","module.exports = __webpack_public_path__ + \"src/assets/miluda/miluda_atk_sw.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/miluda/miluda_atk_sw.png\n// module id = O4gy\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/miluda/miluda_atk_nw.json\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/miluda/miluda_atk_nw.json\n// module id = O5rI\n// module chunks = 1","const EasingFunction = {\r\n    linear(w) {\r\n        return w\r\n    },\r\n\r\n    outCubic(w) {\r\n        w = w -1\r\n        return w*w*w + 1\r\n    },\r\n\r\n    inCubic(w) {\r\n        return w*w*w\r\n    },\r\n\r\n    inOutCubic(w) {\r\n        w = w * 2\r\n        if (w < 1) {\r\n            return w*w*w / 2\r\n        } else {\r\n            w = w - 2\r\n            return (w*w*w + 2) / 2\r\n        }\r\n    },\r\n\r\n    inOutSine(w) {\r\n        return (1 - Math.cos(Math.PI * w)) / 2\r\n    },\r\n\r\n    outExponential(w) {\r\n        if (w < 1) {\r\n            return 1- Math.pow(2, -10*w)\r\n        } else {\r\n            return 1\r\n        }\r\n    },\r\n\r\n    outBounce(w) {\r\n        if (w < 4/11.0) {\r\n            return (121 * w * w) / 16.0\r\n        } else if (w < 8/11.0) {\r\n            return  (363 / 40.0 * w * w) - (99 / 10.0 * w) + 17/5.0\r\n        } else if (w < 9/10.0) {\r\n            return (4356 / 361.0 * w * w) - (35442 / 1805.0 * w) + 16061/1805.0\r\n        } else {\r\n            return (54 / 5.0 * w * w) - (513 / 25.0 * w) + 268/25.0\r\n        }\r\n    },\r\n\r\n    outBack(w) {\r\n        const s = 1.70158\r\n        w = w - 1\r\n        return w*w*((s+1)*w+s) + 1\r\n    }\r\n};\r\n\r\nconst MoveClipPlayMode = {\r\n    Loop: 1,\r\n    Stop: 2,\r\n    Destory: 3\r\n}\r\n\r\nexport default class MovieClip {\r\n    static Timeline(startFrame, endFrame, mesh, tweens) {\r\n        if (!Array.isArray(tweens)) {\r\n            tweens = [tweens]\r\n        }\r\n\r\n        return {\r\n            startFrame: startFrame,\r\n            endFrame: endFrame,\r\n            mesh: mesh,\r\n            tweens: tweens\r\n        }\r\n    }\r\n\r\n    constructor(...timelines) {\r\n\r\n        if (!Array.isArray(timelines)) {\r\n            timelines = [timelines]\r\n        }\r\n        \r\n        this._timelines = timelines\r\n        this._frame = 0\r\n        this._playing = false\r\n        this._stopHandler = null\r\n        this._mode = MoveClipPlayMode.Stop // 마지막에 정지가 가장 기본 모드이다\r\n\r\n        // 마지막 프레임을 찾는다\r\n        let lastFrame = 0\r\n        for(const tl of timelines) {\r\n            lastFrame = Math.max(lastFrame, tl.endFrame)\r\n        }\r\n        this._lastFrame = lastFrame\r\n    }\r\n    \r\n    playAndStop(handler) {\r\n        // 가장 기본적인 실행을 한다\r\n        // 마지막 프레임이 지나면 정지를 한다\r\n        this._playing = true\r\n        this._mode = MoveClipPlayMode.Stop\r\n        this._stopHandler = handler\r\n    }\r\n\r\n    playAndDestroy(handler) {\r\n        this._playing = true\r\n        this._mode = MoveClipPlayMode.Destory\r\n        this._stopHandler = handler\r\n    }\r\n\r\n    playLoop() {\r\n        this._playing = true\r\n        this._mode = MoveClipPlayMode.Loop\r\n    }\r\n\r\n    update() {\r\n        this._frame++\r\n        if (this._playing) {\r\n            if (this._frame >= this._lastFrame) {\r\n                // 플레이모드에 따라서 루프, 정지, 파괴를 선택한다\r\n                switch(this._mode) {\r\n                    case MoveClipPlayMode.Loop: {\r\n                        this._frame = 1\r\n                        break\r\n                    }\r\n                    case  MoveClipPlayMode.Destory: {\r\n                        if (this._stopHandler) {\r\n                            this._stopHandler()\r\n                        }\r\n                        return\r\n                    }\r\n                    default: {\r\n                        // 정지시킨다\r\n                        this._playing = false\r\n                        this._frame = this._lastFrame\r\n                        if (this._stopHandler) {\r\n                            this._stopHandler()\r\n                        }\r\n                        break\r\n                    }\r\n                }\r\n            }\r\n\r\n            for(const timeline of this._timelines) {\r\n                // 각각의 액션을 실행한다\r\n                if (this._frame < timeline.startFrame || timeline.endFrame < this._frame) {\r\n                    continue\r\n                }\r\n\r\n                const dist = timeline.endFrame - timeline.startFrame\r\n                const weight = dist > 0 ? (this._frame - timeline.startFrame) / dist : 0\r\n                const mesh = timeline.mesh;\r\n\r\n                for(const tween of timeline.tweens) {\r\n                    if (typeof(tween) === \"function\" ) {\r\n                        tween();\r\n                    } else {\r\n                        // 나중에 고쳐두자...\r\n                        const target = tween[0];\r\n                        const from = tween[1];\r\n                        const to = tween[2];\r\n                        const easing = EasingFunction[tween[3]];\r\n\r\n                        const value = easing(weight) * (to - from) + from\r\n                        switch(target) {\r\n                            case \"scaleX\": {\r\n                                //mesh.setScale(value, image.scale.y)\r\n                                break\r\n                            }\r\n                            case \"scaleY\": {\r\n                                //image.setScale(image.scale.x, value)\r\n                                break\r\n                            }\r\n                            case \"scale\": {\r\n                                ///image.setScale(value, value)\r\n                                break\r\n                            }\r\n                            case \"x\": {\r\n                                //image.setPosition(value, image.y)\r\n                                mesh.position.x = Math.floor(value);\r\n                                break\r\n                            }\r\n                            case \"y\": {\r\n                                //image.setPosition(image.x, value)\r\n                                mesh.position.y = Math.floor(value);\r\n                                break\r\n                            }\r\n                            case \"alpha\": {\r\n                                mesh.alpha = value;\r\n                                break\r\n                            }\r\n                            case \"rotation\": {\r\n                                image.setRotation(value)\r\n                                break\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/movieclip.js","module.exports = __webpack_public_path__ + \"src/assets/mapdata/stealBarL.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/mapdata/stealBarL.png\n// module id = On9J\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/night/walk_nw.json\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/night/walk_nw.json\n// module id = PDkE\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/player2_active.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/player2_active.png\n// module id = PHls\n// module chunks = 1","\n\nexport default class MoveEngine {\n    constructor(engine) {\n        this.engine = engine;\n\n        this.activeForMovables = false;\n        this.activeForTweens = false;\n        this.processFrame = true;\n        \n    \n        this.movables = [];\n        this.tweenTargets = [];\n\n        this.fps = 60;\n    }\n\n    setObject(o, x, y) {\n        this.object = o;\n        this.speed = 8;\n\n        const px = this.engine.getTilePosXFor(x, y);\n        const py = this.engine.getTilePosYFor(x, y);\n\n        this.speedUnit = getUnit({ x: (px - o.position.x), y: (py - o.position.y) });\n        \n        this.currentTarget = { x: px, y: py };\n    }\n\n    getUnit(v) {\n        const m = Math.sqrt(v.x * v.x + v.y * v.y);\n        return { x: v.x / m, y: v.y / m };\n    };\n\n    getDist(pos1, pos2) {\n        const x = pos1.x - pos2.x;\n        const y = pos1.y - pos2.y;\n        return Math.sqrt(x*x + y*y);\n    }\n\n    addMovable(o) {\n        if (this.movables.indexOf(o) >= 0) {\n            return;\n        }\n        \n        this.movables[this.movables.length] = o;\n\n        o.positionR = { x: o.position.x, y: o.position.y };\n        \n        if (this.movables.length > 0 && !this.activeForMovables) {\n            this.activeForMovables = true;\n        }\n    };\n\n    removeMovable(o) {\n        const idx = this.movables.indexOf(o); \n        if (idx !== -1)\n        {\n            o.positionR = null;\n            o.speedUnit = { x: 0, y: 0 };\n            this.movables.splice(idx, 1);\n        }\n        \n        if (this.movables.length === 0)\n        {\n            this.activeForMovables = false;\n        }\n        \n        // TODO: might be a good idea to remove/reset all related parameters from the object here\n        \n        return (idx !== -1);\n    }\n\n    setMoveParameters(o, x, y) {\n        const px = this.engine.getTilePosXFor(x, y);\n        const py = this.engine.getTilePosYFor(x, y);\n        \n        o.speedUnit = this.getUnit({ x: (px - o.position.x), y: (py - o.position.y) });\n        o.currentTarget = { x: px, y: py };\n        o.currentReachThresh = Math.ceil(Math.sqrt(o.speedUnit.x * o.speedUnit.x + o.speedUnit.y * o.speedUnit.y) * o.speedMagnitude);\n    };\n   \n    update() {\n        if (this.processFrame) {\n            if (this.activeForMovables) {\n                let len = this.movables.length;\n                for (let i=0; i < len; i++)\n                {\n                    const o = this.movables[i];\n                    \n           \n                    // check for target reach\n                    if (o.currentTarget) {\n                        const dist = this.getDist(o.positionR, o.currentTarget);\n                        if (dist <= o.speedMagnitude) {\n                            // reached to the target\n                            o.position.x = o.currentTarget.x;\n                            o.position.y = o.currentTarget.y;\n                            \n                            this.engine.onObjMoveStepEnd(o);\n                            i--; len--;\n                            continue; \n                        }\n                    }\n                  \n                    o.positionR.x += o.speedMagnitude * o.speedUnit.x;\n                    o.positionR.y += o.speedMagnitude * o.speedUnit.y;\n\n                    o.position.x = Math.floor(o.positionR.x);\n                    o.position.y = Math.floor(o.positionR.y);\n                    \n                    // check for tile change\n                    this.engine.checkForTileChange(o);\n                    this.engine.checkForFollowCharacter(o);\n                }\n            }\n            \n            if (this.activeForTweens) {   \n                // and a loop for tween animations\n                let len = this.tweenTargets.length;\n                for (let i=0; i < len; i++)\n                {\n                    const o = this.tweenTargets[i];\n                    const tweens = o.tweens;\n                    for (let j=0; j < tweens.length; j++)\n                    {\n                        const t = tweens[j];\n                        t.currentFrame++;\n                        const vars = t.vars;\n                        for (const prop in vars)\n                        {\n                            o[prop] = t.easingFunc(t.currentFrame, vars[prop].b, vars[prop].c, t.totalFrames);\n                        }\n                        \n                        if (t.currentFrame >= t.totalFrames) {\n                            if (t.onComplete) { t.onComplete(); }\n                            if (this.removeTween(o, t)) \n                            {\n                                i--; len--;\n                            }\n                            j--;\n                        }\n                    }\n                }\n            }\n        }\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/moveengine.js","module.exports = __webpack_public_path__ + \"src/assets/slash_1.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/slash_1.png\n// module id = QJA4\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/dialog.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/dialog.png\n// module id = QKlM\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/night/walk_sw.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/night/walk_sw.png\n// module id = QRr6\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/ending.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/ending.png\n// module id = QSXp\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/mapdata/map2.json\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/mapdata/map2.json\n// module id = QyYQ\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/btn_centralize.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/btn_centralize.png\n// module id = R2tb\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/ch03_skill01.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/ch03_skill01.png\n// module id = RWdx\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/inventory.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/inventory.png\n// module id = S0Ft\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/night/sword_sw.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/night/sword_sw.png\n// module id = S6X1\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/pbar.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/pbar.png\n// module id = SE36\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/combine_listitem.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/combine_listitem.png\n// module id = SJkF\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/player3.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/player3.png\n// module id = SPZO\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/player1.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/player1.png\n// module id = TCQi\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/assets_characters.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/assets_characters.png\n// module id = ThIZ\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/ch01_skill02_on.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/ch01_skill02_on.png\n// module id = Thq4\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/medusa/monster1-atk_sw.json\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/medusa/monster1-atk_sw.json\n// module id = UOdx\n// module chunks = 1","const TILE_WIDTH  = 32;\r\nconst TILE_HEIGHT = 16;\r\n\r\nexport default class Tile extends PIXI.Container {\r\n    constructor(x, y, options) {\r\n        super();\r\n        this.gridX = x;\r\n        this.gridY = y;\r\n\r\n        // 스프라이트 정보를 출력한다\r\n        const texture = PIXI.Texture.fromFrame(options.textureName);\r\n        const sprite = new PIXI.Sprite(texture);\r\n        sprite.position.y = -texture.height;\r\n        this.addChild(sprite);\r\n        this.tileTexture = sprite;\r\n\r\n        // 타일 영역에 대한 버텍스를 만든다\r\n        const vertices = [\r\n            [0, -TILE_HEIGHT/2],\r\n            [TILE_WIDTH/2, -TILE_HEIGHT],\r\n            [TILE_WIDTH, -TILE_HEIGHT/2],\r\n            [TILE_WIDTH/2, 0]\r\n        ];\r\n        this.vertices = vertices;\r\n\r\n        // 하이라이트를 만든다\r\n        // TODO : 모든 타일에 대해서 하이라이트를 만들 필요가 있을까? 바닥타일만 하이라이트를 만들고 싶다\r\n        this.highlightedOverlay = new PIXI.Graphics();\r\n        this.highlightedOverlay.clear();\r\n        this.highlightedOverlay.lineStyle(2, 0xFFFFFF, 1);\r\n        this.highlightedOverlay.beginFill(0x80d7ff, 0.5);\r\n        this.highlightedOverlay.moveTo(vertices[0][0], vertices[0][1]);\r\n        for (let i = 1; i < vertices.length; i++)\r\n        {\r\n            this.highlightedOverlay.lineTo(vertices[i][0], vertices[i][1]);\r\n        }\r\n        this.highlightedOverlay.lineTo(vertices[0][0], vertices[0][1]);\r\n        this.highlightedOverlay.endFill();\r\n        this.addChild(this.highlightedOverlay);\r\n\r\n        this.highlightedOverlay.visible = false;\r\n        this.isHighlighted = false;\r\n        \r\n        this.movable = options.movable || false;\r\n    }\r\n\r\n    setTexture(texture) {\r\n        this.tileTexture.texture = texture;\r\n        this.tileTexture.position.y = -texture.height;\r\n    } \r\n\r\n    // 어떻게 해야하냐.. 고민고민\r\n    setObject(object) {\r\n        this.addChild(object);\r\n    }\r\n\r\n    removeObject(object) {\r\n        this.removeChild(object);\r\n    }\r\n\r\n    setHighlighted(isHighlighted) {\r\n\r\n        if (this.isHighlighted !== isHighlighted)\r\n        {\r\n            this.highlightedOverlay.visible = isHighlighted;\r\n            this.isHighlighted = isHighlighted;\r\n        }\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/tile.js","module.exports = __webpack_public_path__ + \"src/assets/elid/elid_idle_nw.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/elid/elid_idle_nw.png\n// module id = W/RV\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/mapdata/objects.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/mapdata/objects.png\n// module id = XvEF\n// module chunks = 1","export default class ResourceManager {\r\n    constructor() {\r\n        this.cache = {};\r\n        this.loader = this.getNewLoader();\r\n    }\r\n\r\n    getNewLoader() {\r\n        const loader = new PIXI.loaders.Loader();\r\n        loader.pre(this.memoryMiddleware.bind(this));\r\n        return loader;\r\n    }\r\n\r\n    memoryMiddleware(resource, next) {\r\n        // if cached, then set data and complete the resource\r\n        if (this.cache[resource.url]) {\r\n            resource.data = this.cache[resource.url];\r\n            resource.complete(); // marks resource load complete and stops processing before middlewares\r\n        }\r\n        // if not cached, wait for complete and store it in the cache.\r\n        else {\r\n            resource.onComplete.once(() => {\r\n                this.cache[resource.url] = resource.data;\r\n            });\r\n        }\r\n\r\n        next();\r\n    }\r\n\r\n    add(name, url) {\r\n        if (url) {\r\n            this.loader.add(name, require('../' + url));\r\n        } else {\r\n            this.loader.add(require('../' + name));\r\n        }\r\n    }\r\n\r\n    load(onLoadComplete) {\r\n        const loader = this.loader;\r\n        this.loader = this.getNewLoader();\r\n\r\n        loader.load((_, resources) => {\r\n            onLoadComplete(resources);\r\n        });\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/resource-manager.js","module.exports = __webpack_public_path__ + \"src/assets/monster02.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/monster02.png\n// module id = ZHXx\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/ui/chatballon_comma.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/ui/chatballon_comma.png\n// module id = aPgd\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/mapdata/objects.json\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/mapdata/objects.json\n// module id = bcYj\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/btn_zoomIn.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/btn_zoomIn.png\n// module id = bxyk\n// module chunks = 1","import ResourceManager from \"./resource-manager\";\r\nimport Tweens from \"./tweens\";\r\nimport Stage  from \"./stage\";\r\nimport { DIRECTIONS } from './define';\r\n\r\nimport Player  from \"./player\";\r\nimport Battle  from \"./battle\";\r\nimport Explore  from \"./explore\";\r\n\r\nexport default class Game {\r\n    constructor(pixi) {\r\n\r\n        const width = pixi.renderer.width;\r\n        const height = pixi.renderer.height;\r\n\r\n        this.screenWidth = width;\r\n        this.screenHeight = height;\r\n\r\n        // 렌더링 레이어를 설정한다\r\n        this.background = new PIXI.Container();\r\n        this.gamelayer = new PIXI.Container(); // 게임용\r\n        this.foreground = new PIXI.Container(); // UI \r\n\r\n        pixi.stage.addChild(this.background);\r\n        pixi.stage.addChild(this.gamelayer);\r\n        pixi.stage.addChild(this.foreground);\r\n\r\n        // 클릭 이벤트\r\n        this.gamelayer.mouseup = this.onGameClick.bind(this);\r\n        this.gamelayer.interactive = true;\r\n\r\n        this.foreground.mouseup = this.onForegroundClick.bind(this);\r\n        this.foreground.interactive = true;\r\n    \r\n        // 암전용 블랙스크린을 설치한다\r\n        const blackScreen = new PIXI.Sprite(PIXI.Texture.WHITE);\r\n        blackScreen.width = width + 128;\r\n        blackScreen.height = height + 128;\r\n        blackScreen.position.x = -64;\r\n        blackScreen.position.y = -64;\r\n        blackScreen.tint = 0;\r\n        pixi.stage.addChild(blackScreen);\r\n        this.blackScreen = blackScreen;\r\n\r\n        this.tweens = new Tweens();\r\n        this.battleMode = new Battle(this);\r\n        this.exploreMode = new Explore(this);\r\n        this.currentMode = null;\r\n        this.nextStageMode = null;\r\n\r\n        this.resourceManager = new ResourceManager();\r\n\r\n\r\n        // TODO :나중에 제거해야한다!!!\r\n        // hitEffect or 화면 효과용 스크린을 설치. (다른곳으로 빼야할듯하다..)\r\n        const whiteScreen = new PIXI.Sprite(PIXI.Texture.WHITE);\r\n        whiteScreen.width = width + 128;\r\n        whiteScreen.height = height + 128;\r\n        whiteScreen.position.x = -64;\r\n        whiteScreen.position.y = -64;\r\n        whiteScreen.alpha = 0;\r\n        pixi.stage.addChild(whiteScreen);\r\n        this.whiteScreen = whiteScreen;\r\n    }\r\n\r\n    start(playerInfo) {\r\n        // 플레이어 정보를 네트워크나 디스크로부터 읽어온 직후이다.\r\n        // 플레이어가 어디에 위치 했는지 확인한다.\r\n        // 플레이어 캐릭터를 만든다\r\n        this.resourceManager.add(\"assets/night/atk_sw.json\");\r\n        this.resourceManager.add(\"assets/night/atk_nw.json\");\r\n        this.resourceManager.add(\"assets/night/idle_sw.json\");\r\n        this.resourceManager.add(\"assets/night/idle_nw.json\");\r\n        this.resourceManager.add(\"assets/night/walk_sw.json\");\r\n        this.resourceManager.add(\"assets/night/walk_nw.json\");\r\n        this.resourceManager.add(\"shadow.png\", \"assets/shadow.png\");\r\n        // 전투용 라이프 바 (지금 로딩할필요가 있을까?)\r\n        this.resourceManager.add(\"pbar.png\", \"assets/pbar.png\");\r\n        this.resourceManager.add(\"pbar_r.png\", \"assets/pbar_r.png\");\r\n        this.resourceManager.add(\"pbar_g.png\", \"assets/pbar_g.png\");\r\n        this.resourceManager.add(\"pbar_o.png\", \"assets/pbar_o.png\");\r\n        // 몬스터용 데이터 (나중에 옮겨야 한다)\r\n        this.resourceManager.add(\"assets/elid/elid_atk_nw.json\");\r\n        this.resourceManager.add(\"assets/elid/elid_atk_sw.json\");\r\n        this.resourceManager.add(\"assets/elid/elid_idle_nw.json\");\r\n        this.resourceManager.add(\"assets/elid/elid_idle_sw.json\");\r\n\r\n        this.resourceManager.add(\"assets/miluda/miluda_atk_sw.json\");\r\n        this.resourceManager.add(\"assets/miluda/miluda_atk_nw.json\");\r\n        this.resourceManager.add(\"assets/miluda/miluda_idle_sw.json\");\r\n        this.resourceManager.add(\"assets/miluda/miluda_idle_nw.json\");\r\n\r\n        this.resourceManager.add(\"assets/titan/monster2-atk_sw.json\");\r\n        this.resourceManager.add(\"assets/titan/monster2-idle_sw.json\");\r\n\r\n        this.resourceManager.add(\"assets/medusa/monster1-atk_sw.json\");\r\n        this.resourceManager.add(\"assets/medusa/monster1_idle_sw.json\");\r\n        \r\n        // 이펙트\r\n        this.resourceManager.add(\"assets/slash_1.json\");\r\n\r\n        this.enterStage(playerInfo.stagePath, \"explore\");\r\n    }\r\n\r\n    enterStage(stagePath, mode) {\r\n        this.nextStageMode = mode;\r\n        if (this.currentStage) {\r\n            // 기존 스테이지에서 나간다\r\n            this.tweens.addTween(this.blackScreen, 1, { alpha: 1 }, 0, \"easeIn\", true, () => {\r\n                this.gamelayer.removeChildren();\r\n\r\n                // 화면 암전이 끝나면 로딩을 시작한다\r\n                this.loadStage(stagePath, this.onStageLoadCompleted.bind(this));\r\n            });\r\n        } else {\r\n            // 바로 로딩을 한다\r\n            this.loadStage(stagePath, this.onStageLoadCompleted.bind(this));\r\n        }\r\n    }\r\n\r\n    enterBattle() {\r\n        // 전투는 별도 처리를 해야 할 듯하다\r\n    }\r\n\r\n    loadStage(stagePath, onLoadComplete) {\r\n        // =======================================================\r\n        // 전투 관련 하드 코딩이다. 나중에 스테이지 관련 핸들링을 변경하다\r\n        // 전투로 넘어갈때는 스테이지 정보를 백업한다\r\n        if (this.nextStageMode === \"battle\") {\r\n            // 배틀로 갈때는 스테이지를 기록한다\r\n            this.exploreMode.stage = this.stage;\r\n            this.exploreMode.backupX = this.player.gridX;\r\n            this.exploreMode.backupY = this.player.gridY;\r\n\r\n        } else if (this.currentMode === this.battleMode) {\r\n            // 전투에서 되돌아올때는 백업을 사용한다\r\n            const backup = this.exploreMode.stage;\r\n            this.exploreMode.fromBattle = true;\r\n            this.exploreMode.stage = undefined;\r\n            onLoadComplete(backup);\r\n            return;\r\n        }\r\n        // =======================================================\r\n\r\n        // 필요한 리소스를 로딩한다\r\n        this.resourceManager.add(\"stage\", stagePath);\r\n        this.resourceManager.add(\"tiles.json\", \"assets/mapdata/tiles.json\");\r\n        this.resourceManager.add(\"tiles.png\", \"assets/mapdata/tiles.png\");\r\n        this.resourceManager.add(\"objects.json\", \"assets/mapdata/objects.json\");\r\n        this.resourceManager.add(\"objects.png\", \"assets/mapdata/objects.png\");\r\n        this.resourceManager.add(\"walls.json\", \"assets/mapdata/walls.json\");\r\n        this.resourceManager.add(\"walls.png\", \"assets/mapdata/walls.png\");\r\n        this.resourceManager.add(\"window_light.png\", \"assets/window_light.png\");\r\n        this.resourceManager.add(\"torch_light.png\", \"assets/torch_light.png\");\r\n        this.resourceManager.add(\"background.png\", \"assets/background.png\");\r\n        this.resourceManager.add(\"stealBarL.png\", \"assets/mapdata/stealBarL.png\");\r\n        this.resourceManager.add(\"stealBarR.png\", \"assets/mapdata/stealBarR.png\");\r\n\r\n    \r\n\r\n        this.resourceManager.load((resources) => {\r\n            if (!this.player) {\r\n                this.player = new Player();\r\n            }\r\n\r\n            const mapData = resources[\"stage\"].data; // 이것은 규칙을 정한다\r\n            const stage = new Stage(mapData.width, mapData.height, mapData.tilewidth, mapData.tileheight);\r\n\r\n            // 타일셋을 먼저 등록한다\r\n            for (const tileset of mapData.tilesets) {\r\n                const tiles = resources[tileset.source].data;\r\n                const prefix = tileset.source.replace('.json', '_');\r\n                const idStart = tileset.firstgid;\r\n\r\n                // ======================================================\r\n                // 타일안에 디테일 데이터가 있으면 별도로 처리한다\r\n                const customTileData = {};\r\n                if (tiles.tiles) {\r\n                    for (const data of tiles.tiles) {\r\n                        const custom = {};\r\n                        // 애니메이션 정보 복사\r\n                        if (data.animation) {\r\n                            custom.animations = [];\r\n                            for(const anim of data.animation) {\r\n                                custom.animations.push({\r\n                                    duration: anim.duration,\r\n                                    textureName: prefix + anim.tileid + \".png\",\r\n                                })\r\n                            }\r\n                        }\r\n                        // 커스텀 프라퍼티 복사\r\n                        for( const property of data.properties) {\r\n                            if (property.name === \"movable\") {\r\n                                custom.movable = property.value;\r\n                            }\r\n                            else if(property.name === \"objectType\") {\r\n                                custom.objectType = property.value;\r\n                            } \r\n                            else if (property.name === \"tag\") {\r\n                                custom.tags = property.value.split(';');\r\n                            }\r\n                            else if (property.name === \"direction\") {\r\n                                custom.direction = (property.value === \"left\") ? DIRECTIONS.SW : DIRECTIONS.SE;\r\n                            }\r\n                        }\r\n                        customTileData[data.id + idStart] = custom;\r\n                    }\r\n                }\r\n                // ======================================================\r\n\r\n                for (let i = 0; i < tiles.tilecount; ++i) {\r\n\r\n                    const textureName = prefix + i + \".png\";\r\n                    if (!PIXI.utils.TextureCache[textureName]) {\r\n\r\n                        const image = resources[tiles.image].data;\r\n\r\n                        const x = i % tiles.columns;\r\n                        const y = Math.floor(i / tiles.columns);\r\n                        const c = document.createElement('canvas');\r\n                        c.width = tiles.tilewidth + 2; \r\n                        c.height = tiles.tileheight + 2;\r\n                        const context = c.getContext('2d');\r\n                        context.drawImage(image, x * tiles.tilewidth, y * tiles.tileheight, tiles.tilewidth, tiles.tileheight, 1, 1, tiles.tilewidth, tiles.tileheight);\r\n                        const texture = PIXI.Texture.fromCanvas(c, new PIXI.Rectangle (1, 1, tiles.tilewidth, tiles.tileheight));\r\n                        PIXI.Texture.addToCache(texture, textureName);\r\n                    }\r\n                    // TODO : 나중에 타일매니져로 교체한다\r\n                    stage.addTile(i+idStart, textureName, customTileData[i + idStart]); \r\n                }\r\n            }\r\n\r\n            // 타일맵을 설정한다\r\n            for (const layer of mapData.layers) {\r\n                for (let y = 0; y < layer.height;++y) {\r\n                    for (let x = 0; x < layer.width;++x) {\r\n                        // 맵툴문제 때문에 90 도를 뒤집어야 한다\r\n                        const index =  y + (layer.width - x -1) * layer.width;\r\n                        const tileId = layer.data[index];\r\n\r\n                        // 90 도 회전시킨다.\r\n                        if (layer.name === \"Tiles\") {\r\n                            // 타일\r\n                            stage.setGroundTile(x, y, tileId);\r\n                        } else {\r\n                            // 오브젝트이다\r\n                            stage.setObjectTile(x, y, tileId);\r\n                        }\r\n\r\n                        // 특수 타일 처리\r\n                        // 이 특수타일들에 대한 정보를 나중에 별도의 데이터로 분리해야한다.\r\n                        // { tileid , tiletype }\r\n                        // 앵커를 없애고 타일좌표로 맞추는것이 필요할지도 모르겠다.\r\n                        if (tileId === 282) {\r\n                            // 윈도우\r\n                            const light = new PIXI.Sprite(PIXI.Texture.fromFrame(\"window_light.png\"));\r\n                            light.anchor.x = 1;\r\n                            light.position.x = stage.getTilePosXFor(x, y) + 15;\r\n                            light.position.y = stage.getTilePosYFor(x, y) + stage.TILE_HALF_H - 71;\r\n                            light.blendMode = PIXI.BLEND_MODES.ADD;\r\n                            stage.overlayContainer.addChild(light)\r\n                        } else if (tileId === 279) {\r\n                            // 토치 라이트\r\n                            const light = new PIXI.Sprite(PIXI.Texture.fromFrame(\"torch_light.png\"));\r\n                            light.anchor.x = 0.5;\r\n                            light.anchor.y = 0.5;\r\n                            light.position.x = stage.getTilePosXFor(x, y) + 16;\r\n                            light.position.y = stage.getTilePosYFor(x, y) + stage.TILE_HALF_H - 69;\r\n                            light.blendMode = PIXI.BLEND_MODES.ADD;\r\n                            stage.overlayContainer.addChild(light)\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            // 렌더링 데이터를 빌드한다\r\n            stage.build();\r\n\r\n            // 로딩 완료 콜백\r\n            if (onLoadComplete) {\r\n                onLoadComplete(stage);\r\n            }\r\n        });\r\n    }\r\n\r\n    onStageLoadCompleted(stage) {\r\n        // 스테이지의 줌레벨을 결정한다\r\n        stage.zoomTo(2, true);\r\n        this.stage = stage;\r\n        this.gamelayer.addChild(stage);\r\n\r\n        // 페이드 인이 끝나면 게임을 시작한다\r\n        if (this.nextStageMode === \"battle\") {\r\n            this.currentMode = this.battleMode;\r\n        } else {\r\n            this.currentMode = this.exploreMode;\r\n        }\r\n        this.nextStageMode = null;\r\n\r\n        this.currentMode.prepare();\r\n\r\n\r\n        // 다시 암전을 밝힌다\r\n        this.tweens.addTween(this.blackScreen, 1, { alpha: 0 }, 0, \"easeOut\", true, () => {\r\n            this.currentMode.start();\r\n        });\r\n    }\r\n\r\n    onGameClick(event) {\r\n        if (this.currentMode && this.currentMode.onGameClick) {\r\n            this.currentMode.onGameClick(event);\r\n        }\r\n    }\r\n\r\n    onForegroundClick(event) {\r\n        if (this.currentMode && this.currentMode.onForegroundClick) {\r\n            this.currentMode.onGameClick(event);\r\n        }\r\n    }\r\n\r\n    update() {\r\n        this.tweens.update();\r\n        if (this.stage) {\r\n            this.stage.update();\r\n        }\r\n        if (this.currentMode) {\r\n            this.currentMode.update();\r\n        }\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/game.js","module.exports = __webpack_public_path__ + \"src/assets/background.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/background.png\n// module id = cf+J\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/night/walk_sw.json\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/night/walk_sw.json\n// module id = co/e\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/combine_button.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/combine_button.png\n// module id = d9pj\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/elid/elid_idle_sw.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/elid/elid_idle_sw.png\n// module id = daie\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/night/idle_sw.json\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/night/idle_sw.json\n// module id = egTb\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/battle-turn_enemy.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/battle-turn_enemy.png\n// module id = h9v0\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/elid/elid_atk_sw.json\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/elid/elid_atk_sw.json\n// module id = hMIW\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/assets_map.json\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/assets_map.json\n// module id = hZSW\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/night/walk_nw.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/night/walk_nw.png\n// module id = i6JU\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/monster03.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/monster03.png\n// module id = iIlD\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/mapdata/map.json\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/mapdata/map.json\n// module id = ilsi\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/miluda/miluda_idle_nw.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/miluda/miluda_idle_nw.png\n// module id = imdM\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/ch01_skill01.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/ch01_skill01.png\n// module id = ixNQ\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/medusa/monster1-atk_sw.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/medusa/monster1-atk_sw.png\n// module id = kQwz\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/battle-turn_player.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/battle-turn_player.png\n// module id = kpgF\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/ch02_skill01_on.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/ch02_skill01_on.png\n// module id = lIDM\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/player3_active.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/player3_active.png\n// module id = m4/X\n// module chunks = 1","import { DIRECTIONS } from './define';\r\nimport Character from \"./character\";\r\nimport MovieClip from \"./movieclip\";\r\n\r\nfunction loadAniTexture(name, count) {\r\n    const frames = [];  \r\n    for (let i = 0; i < count; i++) {\r\n        frames.push(PIXI.Texture.fromFrame(name + i + '.png'));\r\n    }\r\n    return frames;\r\n}\r\n\r\nfunction getDirectionName(dir) {\r\n    if (dir === DIRECTIONS.SE) {\r\n        return 'se';\r\n    } else if (dir === DIRECTIONS.NW) {\r\n        return 'nw';\r\n    } else if (dir === DIRECTIONS.NE) {\r\n        return 'ne';\r\n    } else if (dir === DIRECTIONS.SW) {\r\n        return 'sw';\r\n    }\r\n}\r\n\r\n\r\n\r\n// 얘네 다른곳으로 빼야할 듯 하다..\r\nclass Knight extends Character {\r\n    constructor() {\r\n        super();\r\n        this.removeChild(this.container);\r\n\r\n        // 스프라이트 로드같은것 캐릭터마다 다를테고.. 초상화 같은것도 있을테고.. 음 \r\n        this.name = \"Hector\";\r\n\r\n        // Battle UI\r\n        this.portrait = new PIXI.Sprite(PIXI.Texture.fromFrame(\"player1_active.png\"));\r\n        this.skillAIcon = new PIXI.Sprite(PIXI.Texture.fromFrame(\"ch03_skill01_on.png\"));\r\n        this.skillBIcon = new PIXI.Sprite(PIXI.Texture.fromFrame(\"ch03_skill02.png\"));\r\n\r\n        // Stat\r\n        this.hp = 300;\r\n        this.maxHp = 300;\r\n        this.damage = 120;\r\n        this.balance = 0.85;\r\n        this.ciriticalRate = 0.3;\r\n        this.ciriticalBalance = 1.7;\r\n        this.defense = 0.5;\r\n        \r\n        // Animation\r\n        this.animations.idle_nw = { textures: loadAniTexture(\"idle_nw\", 2), flipX: false };\r\n        this.animations.idle_sw = { textures: loadAniTexture(\"idle_sw\", 2), flipX: false };\r\n        this.animations.idle_ne = { textures: this.animations.idle_nw.textures, flipX: true };\r\n        this.animations.idle_se = { textures: this.animations.idle_sw.textures, flipX: true };\r\n\r\n        this.animations.walk_nw = { textures: loadAniTexture(\"walk_nw\", 8), flipX: false };\r\n        this.animations.walk_sw = { textures: loadAniTexture(\"walk_sw\", 8), flipX: false };\r\n        this.animations.walk_ne = { textures: this.animations.walk_nw.textures, flipX: true };\r\n        this.animations.walk_se = { textures: this.animations.walk_sw.textures, flipX: true };\r\n\r\n        this.animations.attack_nw = { textures: loadAniTexture(\"atk_nw\", 10), flipX: false };\r\n        this.animations.attack_sw = { textures: loadAniTexture(\"atk_sw\", 10), flipX: false };\r\n        this.animations.attack_ne = { textures: this.animations.attack_nw.textures, flipX: true };\r\n        this.animations.attack_se = { textures: this.animations.attack_sw.textures, flipX: true };\r\n\r\n        const anim = new PIXI.extras.AnimatedSprite(this.animations.idle_sw.textures);\r\n        anim.animationSpeed = 0.1;\r\n        anim.play();\r\n        anim.position.y = -48; // 하드코딩\r\n        this.anim = anim;\r\n        this.container.addChild(anim);\r\n\r\n        // 하드코딩\r\n        this.hpHolder.position.y = -this.anim.height - 8;\r\n        this.hpHolder.position.x = 16 - this.hpHolder.width / 2;\r\n        this.hpBar.position.y = -this.anim.height - 7;\r\n        this.hpBar.position.x = 16 - this.hpHolder.width / 2 + 1;\r\n        \r\n        this.addChild(this.container);\r\n    }\r\n}\r\n\r\nclass Wizard extends Character {\r\n    constructor() {\r\n        super();\r\n        this.removeChild(this.container);\r\n\r\n        this.name = \"Elid\";\r\n        this.portrait = new PIXI.Sprite(PIXI.Texture.fromFrame(\"player2_active.png\"));\r\n        this.skillAIcon = new PIXI.Sprite(PIXI.Texture.fromFrame(\"ch01_skill01_on.png\"));\r\n        this.skillBIcon = new PIXI.Sprite(PIXI.Texture.fromFrame(\"ch01_skill02.png\"));\r\n\r\n        this.hp = 150;\r\n        this.maxHp = 150;\r\n        this.damage = 120;\r\n        this.balance = 0.7;\r\n        this.ciriticalRate = 0.2;\r\n        this.ciriticalBalance = 1.5;\r\n        this.defense = 0.4;\r\n        \r\n        // Animation\r\n        this.animations.idle_nw = { textures: loadAniTexture(\"elid_idle_nw\", 1), flipX: false };\r\n        this.animations.idle_sw = { textures: loadAniTexture(\"elid_idle_sw\", 1), flipX: false };\r\n        this.animations.idle_ne = { textures: this.animations.idle_nw.textures, flipX: true };\r\n        this.animations.idle_se = { textures: this.animations.idle_sw.textures, flipX: true };\r\n\r\n        this.animations.attack_nw = { textures: loadAniTexture(\"elid_atk_nw\", 7), flipX: false };\r\n        this.animations.attack_sw = { textures: loadAniTexture(\"elid_atk_sw\", 7), flipX: false };\r\n        this.animations.attack_ne = { textures: this.animations.attack_nw.textures, flipX: true };\r\n        this.animations.attack_se = { textures: this.animations.attack_sw.textures, flipX: true };\r\n\r\n        const anim = new PIXI.extras.AnimatedSprite(this.animations.idle_sw.textures);\r\n        anim.animationSpeed = 0.1;\r\n        anim.play();\r\n        anim.position.y = -48; // 하드코딩\r\n        this.anim = anim;\r\n        this.container.addChild(anim);\r\n\r\n        // 하드코딩\r\n        this.hpHolder.position.y = -this.anim.height - 8;\r\n        this.hpHolder.position.x = 16 - this.hpHolder.width / 2;\r\n        this.hpBar.position.y = -this.anim.height - 7;\r\n        this.hpBar.position.x = 16 - this.hpHolder.width / 2 + 1;\r\n        \r\n        this.addChild(this.container);\r\n    }\r\n}\r\n\r\nclass Archer extends Character {\r\n    constructor() {\r\n        super();\r\n        this.removeChild(this.container);\r\n\r\n        this.name = \"Miluda\";\r\n        this.portrait = new PIXI.Sprite(PIXI.Texture.fromFrame(\"player3_active.png\"));\r\n        this.skillAIcon = new PIXI.Sprite(PIXI.Texture.fromFrame(\"ch02_skill01_on.png\"));\r\n        this.skillBIcon = new PIXI.Sprite(PIXI.Texture.fromFrame(\"ch02_skill02.png\"));\r\n\r\n        this.hp = 100;\r\n        this.maxHp = 100;\r\n        this.damage = 120;\r\n        this.balance = 0.8;\r\n        this.ciriticalRate = 0.5;\r\n        this.ciriticalBalance = 2;\r\n        this.defense = 0.3;\r\n        \r\n        // Animation\r\n        this.animations.idle_nw = { textures: loadAniTexture(\"miluda_idle_nw\", 1), flipX: false };\r\n        this.animations.idle_sw = { textures: loadAniTexture(\"miluda_idle_sw\", 1), flipX: false };\r\n        this.animations.idle_ne = { textures: this.animations.idle_nw.textures, flipX: true };\r\n        this.animations.idle_se = { textures: this.animations.idle_sw.textures, flipX: true };\r\n\r\n        this.animations.attack_nw = { textures: loadAniTexture(\"miluda_atk_nw\", 8), flipX: false };\r\n        this.animations.attack_sw = { textures: loadAniTexture(\"miluda_atk_sw\", 8), flipX: false };\r\n        this.animations.attack_ne = { textures: this.animations.attack_nw.textures, flipX: true };\r\n        this.animations.attack_se = { textures: this.animations.attack_sw.textures, flipX: true };\r\n\r\n        const anim = new PIXI.extras.AnimatedSprite(this.animations.idle_sw.textures);\r\n        anim.animationSpeed = 0.1;\r\n        anim.play();\r\n        anim.position.y = -48; // 하드코딩\r\n        this.anim = anim;\r\n        this.container.addChild(anim);\r\n\r\n        // 하드코딩\r\n        this.hpHolder.position.y = -this.anim.height - 8;\r\n        this.hpHolder.position.x = 16 - this.hpHolder.width / 2;\r\n        this.hpBar.position.y = -this.anim.height - 7;\r\n        this.hpBar.position.x = 16 - this.hpHolder.width / 2 + 1;\r\n        \r\n        this.addChild(this.container);\r\n    }\r\n}\r\n\r\nclass Troll extends Character {\r\n    constructor() {\r\n        super();\r\n        this.removeChild(this.container);\r\n\r\n        this.portrait = new PIXI.Sprite(PIXI.Texture.fromFrame(\"monster01_active.png\"));\r\n\r\n        this.hp = 300;\r\n        this.maxHp = 300;\r\n        this.damage = 30;\r\n        this.balance = 0.7;\r\n        this.ciriticalRate = 0.2;\r\n        this.ciriticalBalance = 1.2;\r\n        this.defense = 0.5;\r\n        \r\n        // Animation\r\n        this.animations.idle_sw = { textures: loadAniTexture(\"monster2-idle_sw\", 1), flipX: false };\r\n        this.animations.idle_se = { textures: this.animations.idle_sw.textures, flipX: true };\r\n\r\n        this.animations.attack_sw = { textures: loadAniTexture(\"monster2-atk_sw\", 6), flipX: false };\r\n        this.animations.attack_se = { textures: this.animations.attack_sw.textures, flipX: true };\r\n\r\n        const anim = new PIXI.extras.AnimatedSprite(this.animations.idle_sw.textures);\r\n        anim.animationSpeed = 0.1;\r\n        anim.play();\r\n        anim.position.x = -9\r\n        anim.position.y = -55; // 하드코딩\r\n        this.anim = anim;\r\n        this.container.addChild(anim);\r\n\r\n        // 하드코딩\r\n        this.hpHolder.position.y = -this.anim.height - 8;\r\n        this.hpHolder.position.x = 16 - this.hpHolder.width / 2;\r\n        this.hpBar.position.y = -this.anim.height - 7;\r\n        this.hpBar.position.x = 16 - this.hpHolder.width / 2 + 1;\r\n        \r\n        this.addChild(this.container);\r\n    }\r\n\r\n    // Troll 이놈 에니메이션 좌표가 맞지않아서 임의 세팅\r\n    setAnimation(name) {\r\n        const ani = this.animations[name];\r\n        if (ani && this.anim.name !== name) {\r\n            this.anim.name = name;\r\n            this.anim.textures = ani.textures;\r\n            this.anim.scale.x = ani.flipX ? -1 : 1;\r\n            // this.anim.position.x = ani.flipX ? this.anim.width : 0;\r\n            this.anim.gotoAndPlay(0);\r\n\r\n        }\r\n    }\r\n}\r\n\r\nclass Medusa extends Character {\r\n    constructor() {\r\n        super();\r\n        this.removeChild(this.container);\r\n\r\n        this.portrait = new PIXI.Sprite(PIXI.Texture.fromFrame(\"monster02_active.png\"));\r\n\r\n        this.hp = 150;\r\n        this.maxHp = 150;\r\n        this.damage = 50;\r\n        this.balance = 0.8;\r\n        this.ciriticalRate = 0.4;\r\n        this.ciriticalBalance = 1.5;\r\n        this.defense = 0.3;\r\n        \r\n        // Animation\r\n        this.animations.idle_sw = { textures: loadAniTexture(\"monster1_idle_sw\", 1), flipX: false };\r\n        this.animations.idle_se = { textures: this.animations.idle_sw.textures, flipX: true };\r\n\r\n        this.animations.attack_sw = { textures: loadAniTexture(\"monster1-atk_sw\", 4), flipX: false };\r\n        this.animations.attack_se = { textures: this.animations.attack_sw.textures, flipX: true };\r\n\r\n        const anim = new PIXI.extras.AnimatedSprite(this.animations.idle_sw.textures);\r\n        anim.animationSpeed = 0.1;\r\n        anim.play();\r\n        anim.position.y = -48; // 하드코딩\r\n        this.anim = anim;\r\n        this.container.addChild(anim);\r\n\r\n        // 하드코딩\r\n        this.hpHolder.position.y = -this.anim.height - 8;\r\n        this.hpHolder.position.x = 16 - this.hpHolder.width / 2;\r\n        this.hpBar.position.y = -this.anim.height - 7;\r\n        this.hpBar.position.x = 16 - this.hpHolder.width / 2 + 1;\r\n        \r\n        this.addChild(this.container);\r\n    }\r\n}\r\n\r\nclass Wolf extends Character {\r\n    constructor() {\r\n        super();\r\n        this.removeChild(this.container);\r\n\r\n        this.portrait = new PIXI.Sprite(PIXI.Texture.fromFrame(\"monster02_active.png\"));\r\n\r\n        this.hp = 150;\r\n        this.maxHp = 150;\r\n        this.damage = 50;\r\n        this.balance = 0.8;\r\n        this.ciriticalRate = 0.4;\r\n        this.ciriticalBalance = 1.5;\r\n        this.defense = 0.3;\r\n        \r\n        // Animation\r\n        this.animations.idle_sw = { textures: loadAniTexture(\"monster1_idle_sw\", 1), flipX: false };\r\n        this.animations.idle_se = { textures: this.animations.idle_sw.textures, flipX: true };\r\n\r\n        this.animations.attack_sw = { textures: loadAniTexture(\"monster1-atk_sw\", 4), flipX: false };\r\n        this.animations.attack_se = { textures: this.animations.attack_sw.textures, flipX: true };\r\n\r\n        const anim = new PIXI.extras.AnimatedSprite(this.animations.idle_sw.textures);\r\n        anim.animationSpeed = 0.1;\r\n        anim.play();\r\n        anim.position.y = -48; // 하드코딩\r\n        this.anim = anim;\r\n        this.container.addChild(anim);\r\n\r\n        // 하드코딩\r\n        this.hpHolder.position.y = -this.anim.height - 8;\r\n        this.hpHolder.position.x = 16 - this.hpHolder.width / 2;\r\n        this.hpBar.position.y = -this.anim.height - 7;\r\n        this.hpBar.position.x = 16 - this.hpHolder.width / 2 + 1;\r\n        \r\n        this.addChild(this.container);\r\n    }\r\n}\r\n\r\n\r\n// 전투 씬을 구성하고 싸우게 한다\r\nexport default class Battle {\r\n    constructor(game) {\r\n        this.game = game;\r\n        this.callback = null;\r\n\r\n        this.movies = [];\r\n    }\r\n\r\n    prepare() {\r\n        const stage = this.game.stage;\r\n\r\n        this.players = [];\r\n        this.enemies = [];\r\n\r\n        this.loadCharacter();\r\n\r\n        this.cutscene = true;\r\n        this.game.ui.showTheaterScreen(0);\r\n        this.game.ui.battleUi.setBattleUi(this.players, this.enemies);\r\n        this.game.stage.focusBattleCenter();\r\n\r\n        stage.onTileSelected = null;\r\n    }\r\n\r\n    setBattleEndCallback(callback) {\r\n        this.callback = callback;\r\n    }\r\n\r\n    start() {\r\n        this.battleIntro();\r\n    }\r\n\r\n    loadCharacter() {\r\n        const spawnPoint = { x: 6, y: 7 };\r\n\r\n        // 하드코딩 수정할 것. (파티의 개념이 어딘가에 있어야 할 것 같고.. enemies를 어디서 어떻게 불러올까.. 우선 하드코딩)\r\n        const player = new Wizard();\r\n        this.players.push(player);\r\n        this.game.stage.addCharacter(player, spawnPoint.x, spawnPoint.y - 2);\r\n        player.changeVisualToDirection(DIRECTIONS.NE);\r\n\r\n        const player_2 = new Archer();\r\n        this.players.push(player_2);\r\n        this.game.stage.addCharacter(player_2, spawnPoint.x, spawnPoint.y);\r\n        player_2.changeVisualToDirection(DIRECTIONS.NE);\r\n\r\n        const player_3 = new Knight();\r\n        this.players.push(player_3);\r\n        this.game.stage.addCharacter(player_3, spawnPoint.x, spawnPoint.y + 2);\r\n        player_3.changeVisualToDirection(DIRECTIONS.NE);\r\n\r\n        // 적을 추가한다\r\n        const enemy = new Medusa();\r\n        this.game.stage.addCharacter(enemy, 12, 5);\r\n        this.enemies.push(enemy);\r\n\r\n        // 적을 추가한다\r\n        const enemy_2 = new Troll();\r\n        this.game.stage.addCharacter(enemy_2, 12, 7);\r\n        this.enemies.push(enemy_2);\r\n\r\n        // 적을 추가한다\r\n        const enemy_3 = new Wolf();\r\n        this.game.stage.addCharacter(enemy_3, 12, 9);\r\n        this.enemies.push(enemy_3);\r\n    }\r\n\r\n    battleIntro() {\r\n        var flow = 0;\r\n\r\n        // Intro Cutscene (하드코딩 수정할 것..) 캐릭터별 대사가 있을것이고.. 캐릭터 배열이 있을테니 추후 하드코딩 수정할것\r\n        var intro = () => {\r\n            if (flow == 0) {\r\n                this.game.stage.focusBattleObject(this.enemies[1]);\r\n                setTimeout(() => {\r\n                    this.game.ui.showChatBallon(this.enemies[1], \"인간 냄새가 나는군..\");\r\n                }, 550);\r\n            } else if (flow == 1) {\r\n                this.game.stage.focusBattleObject(this.players[2]);\r\n                setTimeout(() => {\r\n                    this.game.ui.showChatBallon(this.players[2], \"각오하라고!!\");\r\n                }, 550);\r\n            } else if (flow == 2) {\r\n                this.cutscene = false;\r\n                this.game.ui.hideTheaterScreen(1);\r\n                this.game.stage.focusBattleCenter();\r\n                this.game.ui.battleUi.showUi();\r\n                this.players.forEach((player) => {\r\n                    // this.game 넘기는 것 수정.\r\n                    player.setUiVisible(this.game, true);\r\n                });\r\n                this.enemies.forEach((enemy) => {\r\n                    enemy.setUiVisible(this.game, true);\r\n                })\r\n            }\r\n\r\n            setTimeout(() => {\r\n                if (flow === 2) {\r\n                    this.turnCount = 0;\r\n                    this.nextTurn();\r\n                } else {\r\n                    flow++;\r\n                    intro();\r\n                }\r\n            }, 1200);\r\n        }\r\n\r\n        intro();\r\n    }\r\n\r\n    nextTurn() {\r\n        // 양측 살아있는 인원조사\r\n        let enemiesLength = 0;\r\n        this.enemies.forEach((enemy) => {\r\n            if (enemy.hp > 0) {\r\n                enemiesLength++;\r\n            }\r\n        });\r\n\r\n        let playerLength = 0;\r\n        this.players.forEach((player) => {\r\n            if (player.hp > 0) {\r\n                playerLength++;\r\n            }\r\n        });\r\n\r\n        if (enemiesLength === 0) {\r\n            this.gameEnd();\r\n        } else if (playerLength === 0) {\r\n            this.gameEnd();\r\n        } else if (this.turnCount % 4 === 0) {\r\n            // 사용자 턴 양측 tint 조정.\r\n            this.game.ui.showStageTitle(\"Player's Turn\");\r\n\r\n            this.players.forEach((player) => {\r\n                if (player.hp > 0) {\r\n                    player.status = 'idle';\r\n                    player.anim.tint = 0xFFFFFF;\r\n                }\r\n            });\r\n\r\n            this.enemies.forEach((enemy) => {\r\n                enemy.anim.tint = 0xBBBBBB;\r\n            });\r\n\r\n            setTimeout(() => {\r\n                this.turnCount = 1;\r\n                this.nextTurn();\r\n            }, 1000);\r\n        } else if (this.turnCount % 4 === 1) {\r\n            let index = -1;\r\n            this.players.forEach((player, i) => {\r\n                if (player.status === 'idle' && index == -1) {\r\n                    index = i;\r\n                }\r\n            });\r\n\r\n            if (index === -1) {\r\n                this.turnCount = 2;\r\n                this.nextTurn();\r\n            } else {\r\n                this.turn(this.players[index], this.nextTurn.bind(this));\r\n            }\r\n        } else if (this.turnCount % 4 === 2) {\r\n            this.game.ui.showStageTitle(\"Enemy's Turn\");\r\n\r\n            this.enemies.forEach((enemy) => {\r\n                if (enemy.hp > 0) {\r\n                    enemy.status = 'idle';\r\n                    enemy.anim.tint = 0xFFFFFF;\r\n                }\r\n            });\r\n\r\n            setTimeout(() => {\r\n                this.turnCount = 3;\r\n                this.nextTurn();\r\n            }, 1000);\r\n        } else {\r\n            let index = -1;\r\n            this.enemies.forEach((enemy, i) => {\r\n                if (enemy.status === 'idle' && index == -1) {\r\n                    index = i;\r\n                }\r\n            });\r\n\r\n            if (index === -1) {\r\n                this.turnCount = 0;\r\n                this.nextTurn();\r\n            } else {\r\n                this.turn(this.enemies[index], this.nextTurn.bind(this));\r\n            }\r\n        }\r\n    }\r\n\r\n    gameEnd() {\r\n        // ending_victory\r\n        this.game.ui.battleUi.hideUi();\r\n\r\n        const victory = new PIXI.Sprite(PIXI.Texture.fromFrame(\"ending_victory.png\"));\r\n        victory.alpha = 0;\r\n        this.game.ui.battleUi.addChild(victory);\r\n        this.game.tweens.addTween(victory, 1, { alpha: 1 }, 1, \"easeInOut\", true, ()=> {\r\n            victory.interactive = true;\r\n            victory.mouseup = () => {\r\n                // 스테이지 변경을 한다 그런데... 페이드 아웃되었을때에 \r\n                this.game.enterStage('assets/mapdata/map.json', \"explore\");\r\n            };\r\n        });\r\n    }\r\n\r\n    // 이제 Character를 안받아도 되겠으나.. 지금 player턴인지.. enemies턴인지 알기위해 일단 둔다..\r\n    turn(character, onEndTurn) {\r\n        // 턴이 종료되면 callback 을 부른다\r\n        // 사용자의 입력을 기다린다\r\n\r\n        // 하드코딩 수정할 것..\r\n        this.waitCommand(character, (character, command) => {\r\n            if (command === \"attack\") {\r\n                // 공격을 한다\r\n                // 상대를 향해 조금 이동을 하고 \r\n                // 이동이 끝나면 공격 모션을 플레이한다\r\n                // 모든 것이 끝나면 턴종료를 한다\r\n                let opponent;\r\n                if (this.players.indexOf(character) >= 0) {\r\n                    this.enemies.forEach((enemy) => {\r\n                        if (enemy.hp > 0 && !opponent) {\r\n                            opponent = enemy;\r\n                        }\r\n                    });\r\n                } else {\r\n                    this.players.forEach((player) => {\r\n                        if (player.hp > 0 && !opponent) {\r\n                            opponent = player;\r\n                        }\r\n                    });\r\n                }\r\n\r\n                character.status = 'done';\r\n\r\n                const start = { x: character.position.x, y: character.position.y };\r\n                const to = { x: (opponent.position.x - character.position.x) / 10 * 3 + character.position.x, y: (opponent.position.y - character.position.y) / 10 * 3 + character.position.y };\r\n\r\n                const movieClip = new MovieClip(\r\n                    MovieClip.Timeline(1, 1, null, () => {\r\n                        // 준비동작을 한다\r\n                    }),\r\n                    MovieClip.Timeline(1, 30, character, [\r\n                        [\"x\", start.x, to.x, \"outCubic\"],\r\n                        [\"y\", start.y, to.y, \"outCubic\"]]),\r\n                    MovieClip.Timeline(31, 31, null, () => {\r\n                        // 공격모션을 플레이한다\r\n                        character.setAnimation('attack_' + getDirectionName(character.currentDir))\r\n                        character.anim.loop = false;\r\n                    }),\r\n                    MovieClip.Timeline(91, 91, null, () => {\r\n                        // 데미지 연산하고, 히트이펙트를 추가한다\r\n                        // 데미지를 입었을 때, 죽음 처리를 어떻게 해야할까.... 체력은 어디서 까야하지..?\r\n                        // 이펙트는 어디서 주는가?..\r\n                        let damage = Math.round((character.damage * character.balance) + (Math.random() * (1 - character.balance) * character.damage) * (1 - opponent.defense));\r\n                        let fontColor = \"#FFFFFF\";\r\n                        if (Math.random() < character.ciriticalRate) {\r\n                            fontColor = \"#FF0000\";\r\n                            damage = Math.round(damage * character.ciriticalBalance);\r\n                            opponent.onDamage(this.game, damage, { type: 'Slash', critical: true });\r\n                        } else {\r\n                            opponent.onDamage(this.game, damage, { type: 'Slash' });\r\n                        }\r\n\r\n                        this.hitEffect(opponent, damage, fontColor);\r\n                    }),\r\n                    MovieClip.Timeline(111, 111, null, () => {\r\n                        // 다시 준비동작을 한다\r\n                        character.setAnimation('idle_' + getDirectionName(character.currentDir))\r\n                        character.anim.loop = true;\r\n                    }),\r\n                    MovieClip.Timeline(111, 140, character, [\r\n                        [\"x\", to.x, start.x, \"outCubic\"],\r\n                        [\"y\", to.y, start.y, \"outCubic\"]]),\r\n                    MovieClip.Timeline(141, 141, null, () => {\r\n                        character.anim.tint = 0xBBBBBB;\r\n                        setTimeout(onEndTurn, 1);\r\n                    }),\r\n                );\r\n                this.movies.push(movieClip);\r\n                movieClip.playAndStop(); // 이것을 기본으로 한다..\r\n            }\r\n        })\r\n    }\r\n\r\n    waitCommand(character, onCommandCallback) {\r\n        // onCommandCallback(\"attack\");\r\n        // opponent 변경도 필요하다..\r\n        if (this.players.indexOf(character) >= 0) {\r\n            // Player일경우. battle UI에서 커멘드를 받는다..\r\n            this.game.ui.battleUi.getCommand((character, command) => {\r\n                onCommandCallback(character, \"attack\");\r\n            });\r\n        } else {\r\n            onCommandCallback(character, \"attack\");\r\n        }\r\n    }\r\n\r\n    hitEffect(target, damage, color) {\r\n        const style = new PIXI.TextStyle();\r\n        style.dropShadow = true;\r\n        style.dropShadowDistance = 3;\r\n        style.fontStyle = 'italic';\r\n        style.fontWeight = 'bold';\r\n        style.fontSize = 20;\r\n        style.fill = color ? color : \"#ffffff\";\r\n        const text = new PIXI.Text('-' + damage, style);\r\n        text.anchor.x = 0.5;\r\n        text.position.y = -24;\r\n        text.alpha = 0;\r\n        target.addChild(text);\r\n\r\n        // 페이드인하면서 위로 조금 올라온다\r\n        const movieClip = new MovieClip(\r\n            MovieClip.Timeline(1, 30, text, [[\"alpha\", 0, 1, \"outCubic\"]]),\r\n            MovieClip.Timeline(1, 30, text, [[\"y\", -24, -36, \"outCubic\"]]),\r\n            MovieClip.Timeline(61, 91, text, [[\"alpha\", 1, 0, \"outCubic\"]]),\r\n            MovieClip.Timeline(91, 91, null, () => {\r\n                target.removeChild(text);\r\n            }),\r\n        );\r\n        this.movies.push(movieClip);\r\n        movieClip.playAndStop(); // 이것을 기본으로 한다..\r\n\r\n    }\r\n\r\n    update() {\r\n        let len = this.movies.length;\r\n        for (let i = 0; i < len; i++) {\r\n            const movie = this.movies[i];\r\n            movie.update();\r\n            if (!movie._playing) {\r\n                this.movies.splice(i, 1);\r\n                i--; len--;\r\n            }\r\n        }\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/battle.js","module.exports = __webpack_public_path__ + \"src/assets/ui/chatballon.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/ui/chatballon.png\n// module id = mm+o\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/miluda/miluda_idle_sw.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/miluda/miluda_idle_sw.png\n// module id = mmyy\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/ch01_skill01_on.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/ch01_skill01_on.png\n// module id = n0x2\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/titan/monster2-atk_sw.json\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/titan/monster2-atk_sw.json\n// module id = nqSm\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/mapdata/stealBarR.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/mapdata/stealBarR.png\n// module id = ob3r\n// module chunks = 1","import { DIRECTIONS } from './define';\n\nexport default class Explore {\n    constructor(game) {\n        this.game = game;\n    }\n\n    prepare() {\n        // 플레이어를 맵에 추가한다\n        // 맵에 스타팅 포인트가 있어야 하는데? \n\n        if (this.fromBattle) {\n            // 전투에서 되돌아 올때는 따로 연출없이 바로 온다\n            const stage = this.game.stage\n            const player = this.game.player;\n            stage.addCharacter(player, this.backupX, this.backupY);\n            stage.checkForFollowCharacter(player, true);\n            player.setUiVisible(this.game, false);\n            \n        } else {\n            const spawnPoint = { x: 3, y: 1 };\n\n            const stage = this.game.stage\n            const player = this.game.player;\n            stage.addCharacter(player, spawnPoint.x, spawnPoint.y);\n            stage.checkForFollowCharacter(player, true);\n            player.setUiVisible(this.game, false);\n\n            // 캐릭터 방향을 돌린다\n            this.game.player.changeVisualToDirection(DIRECTIONS.SE);\n\n            // 컷신준비를 한다\n            this.cutscene = true;\n            this.game.ui.showTheaterScreen(0);\n            this.game.stage.showPathHighlight = false;\n\n            this.game.stage.onTouchObject = this.onTouchObject.bind(this);\n            this.game.stage.onTilePassing = this.onTilePassing.bind(this);\n\n            // 게이트를 열어놓는다\n            const gate = this.game.stage.getObjectAt(3, 1);\n            gate.open();\n        }\n    }\n\n    start() {\n        this.game.stage.onTileSelected = this.onTileSelected.bind(this);\n\n        if (this.fromBattle) {\n            // 바로 컷신을 끝낸다\n        } else {\n            //=======================\n            // 컷신 하드코딩\n            // 스테이지 이름을 화면에 출력한다\n            this.game.ui.showStageTitle(\"어둠의 성탑 99층\");\n            // 플레이어를 적당한 곳으로 이동시킨다\n            this.game.stage.moveCharacter(this.game.player, 4,4);\n            setTimeout(() => {\n                // 게이트문을 찾아서 닫는다.\n                const gate = this.game.stage.getObjectAt(3, 1);\n                gate.close(this.game.tweens);\n            }, 2000);\n\n            setTimeout(() => {\n                this.game.ui.showChatBallon(this.game.player, \"큰일이다 문이 닫혔다!\\n어떻게 하면 나갈 수 있을까 ...\", 4);\n                // 컷신을 끝낸다\n                this.cutscene = false;\n                this.game.ui.hideTheaterScreen(1);\n                this.game.stage.showPathHighlight = true;\n            }, 3000);\n        }\n    }\n\n    onGameClick(event) {\n        if (this.cutscene) {\n            // 컷신중에는 입력을 막는다.\n            event.stopped = true;\n            return;\n        }\n\n        if (this.game.stage) {\n            this.game.stage.checkForTileClick(event.data);\n        }\n    }\n\n    onTouchObject(obj) {\n        if (obj) {\n            obj.touch(this.game);\n        }\n    }\n\n    onTilePassing(obj) {\n        if (obj === this.game.player) {\n            if (obj.gridX === 18 && (obj.gridY === 15 || obj.gridY === 16)) {\n                // 컷신을 튼다\n                this.cutscene = true;\n                this.game.ui.showTheaterScreen(1);\n                this.game.stage.showPathHighlight = false;\n\n                this.game.player.changeVisualToDirection(DIRECTIONS.SE);\n\n                // 1초후에 대사를 하고 \n                setTimeout(() => {\n                    this.game.ui.showChatBallon(this.game.player, \"이 게임에서 드디어 탈출이다. 집에가자\", 4);\n                }, 500)\n                \n                \n                // 다시 1초후에 화면을 암전하고 엔딩크레딧을 보여준다\n                setTimeout(() => {\n                    const sprite = new PIXI.Sprite(PIXI.Texture.fromFrame(\"ending.png\"));\n                    this.game.ui.addChild(sprite);\n                    sprite.alpha = 0;\n                    this.game.tweens.addTween(sprite, 1, { alpha: 1 }, 0, \"easeIn\", true);\n                }, 2000);\n\n\n                \n\n                // 플레이어의 이동을 멈춘다\n                // TODO : 기타게임 상태를 정리하여야 한다. 어떻게 할 지 고민하고 코드를 정리해보자.\n                return true;\n            }\n        }\n    }\n\n    onForegroundClick(event) {\n        // ui 클릭을 만들어야 한다\n    }\n\n    onTileSelected(x, y) {\n        // 해당 타일이 이동가능한 타일인가?\n        const target =  this.game.stage.getObjectAt(x, y);\n        this.target = target;\n        // 해당 타일에 무엇이 있는지 확인한다\n        // 목표에 도착했을때 타겟에 대한 인터랙션을 어떻게 하지?\n\n        // 이동 루틴을 다시 만들어야 한다\n        // 타겟이 있을때에는 타겟을 제외한 패스가 만들어졌을때 마지막 패스끝에 타겟 인터랙션을 달아야 한다.\n        // 패스가 만들어지지 않으면, 타겟팅을 지정하지 않고 근접한 곳까지 이동한다\n        this.game.stage.moveCharacter(this.game.player, x, y);\n    }\n\n    update() {\n        \n    }\n    \n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/explore.js","module.exports = __webpack_public_path__ + \"src/assets/assets_characters.json\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/assets_characters.json\n// module id = pecr\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/miluda/miluda_idle_nw.json\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/miluda/miluda_idle_nw.json\n// module id = pjYb\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/mapdata/tiles.json\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/mapdata/tiles.json\n// module id = pwQP\n// module chunks = 1","class BaseModal extends PIXI.Container {\r\n    constructor(ui, width, height) {\r\n        super();\r\n\r\n        const plane = new PIXI.mesh.NineSlicePlane(PIXI.Texture.from('dialog.png'), 12, 10, 12, 10);\r\n        plane.position.x = (ui.screenWidth - width) / 2;\r\n        plane.position.y = (ui.screenHeight - height) /2;\r\n        plane.width = width;\r\n        plane.height = height;\r\n        this.plane = plane;\r\n\r\n        const background = new PIXI.Sprite(PIXI.Texture.WHITE);\r\n        background.alpha = 0;\r\n        background.width = ui.screenWidth;\r\n        background.height = ui.screenHeight;\r\n        background.interactive = true; // 클릭을 방지한다\r\n        background.mouseup = this.onClick.bind(this);\r\n        \r\n        this.addChild(background);\r\n        this.addChild(plane);\r\n\r\n        this.onclose = null;\r\n    }\r\n\r\n    addTitle(text) {\r\n        const style = new PIXI.TextStyle({fontFamily : 'Arial', fontSize: 24, fill : 0xffffff, align : 'center' });\r\n        const titleText = new PIXI.Text(text, style);\r\n        const textMetrics = PIXI.TextMetrics.measureText(text, style);\r\n\r\n        const width = this.plane.width - 24;\r\n        const height = textMetrics.height + 16;\r\n\r\n        // 타이틀을 여기에 추가한다\r\n        const titlePlane = new PIXI.mesh.NineSlicePlane(PIXI.Texture.from('dialogtitle.png'), 12, 10, 12, 10);\r\n        titlePlane.position.x = (this.plane.width - width) / 2;\r\n        titlePlane.position.y = 12;\r\n        titlePlane.width = width;\r\n        titlePlane.height = height;\r\n        \r\n        titleText.anchor.x = 0.5;\r\n        titleText.anchor.y = 0.5;\r\n        titleText.position.x = width /2;\r\n        titleText.position.y = height /2;\r\n\r\n        titlePlane.addChild(titleText);\r\n        this.plane.addChild(titlePlane);\r\n    }\r\n\r\n    onClick(event) {\r\n        // 여기서 입력을 가로챈다\r\n        event.stopped = true;\r\n        \r\n        // 창을 닫는다\r\n        this.visible = false;\r\n\r\n        if (this.onclose) {\r\n            this.onclose();\r\n        }\r\n    }\r\n}\r\n\r\nclass ChatBallon extends PIXI.Container {\r\n    constructor(character, chatText) {\r\n        super(); \r\n\r\n        // 한글자씩 나오는 애니메이션을 고민해보자\r\n        this.follower = character;\r\n        \r\n        const MAX_CHAT_WIDTH = 180;\r\n\r\n        const style = new PIXI.TextStyle({fontFamily : 'Arial', fontSize: 12, fill : 0, align : 'center', wordWrap: true, wordWrapWidth: MAX_CHAT_WIDTH });\r\n        const textMetrics = PIXI.TextMetrics.measureText(chatText, style);\r\n\r\n        // 캐릭터의 위치에 맞추어서 넣어야 한다\r\n        \r\n        const plane = new PIXI.mesh.NineSlicePlane(PIXI.Texture.from('chatballon.png'), 12, 10, 12, 10);\r\n        plane.width = textMetrics.width + 36;\r\n        plane.height = textMetrics.height + 36;\r\n        this.plane = plane;\r\n\r\n        const comma = new PIXI.Sprite(PIXI.Texture.from('chatballon_comma.png'));\r\n        comma.position.y = plane.height - 5;\r\n        this.comma = comma;\r\n\r\n        const text = new PIXI.Text(chatText, style);\r\n        text.anchor.x = 0.5;\r\n        text.anchor.y = 0.5;\r\n        text.position.x = plane.width / 2;\r\n        text.position.y = plane.height / 2;\r\n        \r\n\r\n        this.addChild(plane);\r\n        plane.addChild(comma);\r\n        plane.addChild(text);\r\n\r\n        this.updatePosition();\r\n    }\r\n\r\n    updatePosition() {\r\n        const character = this.follower;\r\n        const plane = this.plane;\r\n        const comma = this.comma;\r\n\r\n        const gpos = character.toGlobal(new PIXI.Point(0, 0));\r\n        plane.position.x = Math.max(gpos.x - plane.width / 2, 0);\r\n        plane.position.y = Math.max(gpos.y - character.height - plane.height - 36, 0);\r\n\r\n        comma.position.x = plane.width / 2;\r\n    }\r\n}\r\n\r\n\r\nclass Dialog extends PIXI.Container {\r\n    constructor(ui, width, height) {\r\n        super();\r\n\r\n        const plane = new PIXI.mesh.NineSlicePlane(PIXI.Texture.from('dialog.png'), 12, 10, 12, 10);\r\n        plane.position.x = (ui.screenWidth - width) / 2;\r\n        plane.position.y = (ui.screenHeight - height) - 12;\r\n        plane.width = width;\r\n        plane.height = height;\r\n        this.plane = plane;\r\n\r\n        const background = new PIXI.Sprite(PIXI.Texture.WHITE);\r\n        background.alpha = 0;\r\n        background.width = ui.screenWidth;\r\n        background.height = ui.screenHeight;\r\n        background.interactive = true; // 클릭을 방지한다\r\n        background.mouseup = this.onClick.bind(this);\r\n\r\n        // 다이얼로그안에 내부 사이즈를 구한다\r\n        this.innerWidth = width - 32;\r\n        \r\n        this.addChild(background);\r\n        this.addChild(plane);\r\n\r\n        this.onclose = null;\r\n    }\r\n\r\n    onClick(event) {\r\n        // 여기서 입력을 가로챈다\r\n        event.stopped = true;\r\n        \r\n        // 창을 닫는다\r\n        this.visible = false;\r\n\r\n        if (this.onclose) {\r\n            this.onclose();\r\n        }\r\n    }\r\n\r\n    setText(text) {\r\n        if (this.text) {\r\n            this.plane.removeChild(this.text);\r\n        }\r\n\r\n        // 텍스트를 화면에 뿌린다\r\n        const dialogText = new PIXI.Text(text,{fontFamily : 'Arial', fontSize: 24, fill : 0xffffff, align : 'center', wordWrap: true, wordWrapWidth: this.innerWidth });\r\n        // 화면중앙에 배치를 한다\r\n        dialogText.anchor.x = 0.5;\r\n        dialogText.anchor.y = 0.5;\r\n        dialogText.position.x = this.plane.width /2;\r\n        dialogText.position.y = this.plane.height /2;\r\n        this.text = dialogText;\r\n\r\n        this.plane.addChild(dialogText);\r\n\r\n    }\r\n}\r\n\r\nclass StageTitle extends PIXI.Container {\r\n    constructor(ui, text) {\r\n        super();\r\n        const style = new PIXI.TextStyle({fontFamily : 'Arial', fontSize: 48, fill : 0xffffff, align : 'center', dropShadow: true });\r\n        const title = new PIXI.Text(text, style);\r\n        // 화면중앙에 배치를 한다\r\n        title.anchor.x = 0.5;\r\n        title.anchor.y = 0.5;\r\n        title.position.x = ui.screenWidth/2;\r\n        title.position.y = ui.screenHeight * 0.25;\r\n        this.addChild(title);\r\n\r\n        const textMetrics = PIXI.TextMetrics.measureText(text, style);\r\n        const underline = new PIXI.Sprite(PIXI.Texture.WHITE);\r\n        underline.width = textMetrics.width + 8;\r\n        underline.height = 4;\r\n        underline.anchor.x = 0.5;\r\n        underline.anchor.y = 0.5;\r\n        underline.position.y = textMetrics.height/2 + 4;\r\n\r\n        title.addChild(underline);\r\n        \r\n\r\n        this.title = title;\r\n    }\r\n\r\n    set titleScale(value) {\r\n        this.title.scale.x = value;\r\n    }\r\n\r\n    get titleScale() {\r\n        return this.title.scale.x;\r\n    }\r\n}\r\n\r\nclass InventoryUI extends PIXI.Container {\r\n    constructor(ui) {\r\n        super();\r\n\r\n        const base = new PIXI.Sprite(PIXI.Texture.fromFrame(\"inventory.png\"));\r\n        // 위치는 일단 가운데 ...\r\n        base.anchor.x = 0.5;\r\n        base.anchor.y = 0.5;\r\n        base.position.x = ui.screenWidth / 2;\r\n        base.position.y = ui.screenHeight / 2;\r\n        this.addChild(base);\r\n\r\n        this.base = base;\r\n    }\r\n\r\n    update(playerInventory) {\r\n        this.base.removeChildren();\r\n        // 인벤토리에 있는 아이템을 화면에 표시한다\r\n        let index = 0;\r\n        const inventoryWidth = 4;\r\n        playerInventory.eachItem((item) => {\r\n            // 열쇠를 찍는다\r\n            const x = index % inventoryWidth;\r\n            const y = Math.floor(index / inventoryWidth);\r\n            \r\n            const itemSpr = new PIXI.Sprite(PIXI.Texture.fromFrame(\"item3.png\"));\r\n            itemSpr.position.x = x * 85 + 17 - this.base.width/2;\r\n            itemSpr.position.y = y * 85 + 60 - this.base.height/2;\r\n\r\n            this.base.addChild(itemSpr);\r\n\r\n            ++index;\r\n        });\r\n    }\r\n}\r\n\r\nclass CombineUI extends PIXI.Container {\r\n    constructor(ui) {\r\n        super();\r\n\r\n        // 투명 백그라운드를 만들어서 클릭하면 닫히게 한다\r\n        const background = new PIXI.Sprite(PIXI.Texture.WHITE);\r\n        background.alpha = 0;\r\n        background.width = ui.screenWidth;\r\n        background.height = ui.screenHeight;\r\n        background.interactive = true; // 클릭을 방지한다\r\n        background.mouseup = (event) => { \r\n            event.stopped = true;\r\n            this.visible = false; \r\n        };\r\n        this.addChild(background);\r\n\r\n\r\n        const base = new PIXI.Sprite(PIXI.Texture.fromFrame(\"combine.png\"));\r\n        // 위치는 일단 가운데 ...\r\n        base.anchor.x = 0.5;\r\n        base.anchor.y = 0.5;\r\n        base.position.x = ui.screenWidth / 2;\r\n        base.position.y = ui.screenHeight / 2;\r\n        base.interactive = true;\r\n        base.mouseup = (evt) => { evt.stopped = true; };\r\n        this.addChild(base);\r\n\r\n      \r\n        // 조합하기 버튼을 그린다. 그리고 tint 를 사용해서 비활성화한다. \r\n        const button = new PIXI.Sprite(PIXI.Texture.fromFrame(\"combine_button.png\"));\r\n        button.tint = 0x404040;\r\n        button.position.x = -105;\r\n        button.position.y = 115;\r\n        button.mouseup = (event) => {\r\n            event.stopped = true;\r\n            // 조합이 완성되면 버튼을 클릭해서 조합을 가능하게 한다\r\n            // 아이템이 인벤토리에 있으면 지우고 새로운 아이템을 생성하고 팝업을 알린다\r\n            const itemA = ui.game.player.inventory.getItemByType(1);\r\n            const itemB = ui.game.player.inventory.getItemByType(2);\r\n            if (itemA && itemB) {\r\n                ui.game.player.inventory.deleteItem(itemA.itemId);\r\n                ui.game.player.inventory.deleteItem(itemB.itemId);\r\n\r\n                // 12번을 제거하고 3번을 추가한다\r\n                ui.game.player.inventory.addItem(100, 3);\r\n                this.visible = false;\r\n                ui.showItemAcquire(3, () => {\r\n                    ui.showDialog(\"잠긴 문을 열 수 있게 되었다\");\r\n                });\r\n            }\r\n        };\r\n        base.addChild(button)\r\n\r\n        this.base = base;\r\n        this.button = button;\r\n    }\r\n\r\n    update(game) {\r\n        this.showRecipe(game);\r\n    }\r\n\r\n    showRecipe(game) {\r\n        let clicked = false;\r\n        this.base.removeChildren();\r\n        this.base.addChild(this.button); // 버튼은 달아야 한다\r\n\r\n      \r\n\r\n        // 레시피를 화면 그린다.\r\n        const recipe = new PIXI.Sprite(PIXI.Texture.fromFrame(\"combine_listitem.png\"));\r\n        recipe.position.x = 80;\r\n        recipe.position.y = -108;\r\n        const style = new PIXI.TextStyle({fontFamily : 'Arial', fontSize: 16, fill : 0xffffff, align : 'center' });\r\n        const text = new PIXI.Text(\"출구 열쇠\", style);\r\n        recipe.addChild(text);\r\n\r\n        text.position.x = 15;\r\n        text.position.y = (recipe.height - text.height) / 2;\r\n\r\n        this.base.addChild(recipe);\r\n\r\n        recipe.interactive = true;\r\n        recipe.mouseup = (event) => {\r\n            event.stopped = true;\r\n\r\n            // 마우스 클릭했을때의 이벤트\r\n            // 일단 하드코딩. 여기서 인벤토리를 검사해서 각 레시피를 재표를 채운다\r\n            if (!clicked) {\r\n                const itemA = game.player.inventory.getItemByType(1);\r\n                const itemB = game.player.inventory.getItemByType(2);\r\n                // 아이템 1번과 2번이 존재하면 흰색 아니면 회색으로 표시한다\r\n                const colorA = itemA ? 0xffffff : 0x808080;\r\n                const colorB = itemB ? 0xffffff : 0x808080;\r\n\r\n                const styleA = new PIXI.TextStyle({fontFamily : 'Arial', fontSize: 16, fill : colorA, align : 'center' });\r\n                const textA = new PIXI.Text(\"열쇠 조각 A\", styleA);\r\n                textA.position.x = -280;\r\n                textA.position.y = -96;\r\n\r\n                const styleB = new PIXI.TextStyle({fontFamily : 'Arial', fontSize: 16, fill : colorB, align : 'center' });\r\n                const textB = new PIXI.Text(\"열쇠 조각 B\", styleB);\r\n                textB.position.x = -280;\r\n                textB.position.y = -23;\r\n\r\n                const styleC = new PIXI.TextStyle({fontFamily : 'Arial', fontSize: 16, fill : 0x40FF40, align : 'center' });\r\n                const textC = new PIXI.Text(\"출구 열쇠\", styleC);\r\n                textC.position.x = -280;\r\n                textC.position.y = 72;\r\n\r\n\r\n                // 각각의 레시피를 화면에 출력한다\r\n                this.base.addChild(textA);\r\n                this.base.addChild(textB);\r\n                this.base.addChild(textC);\r\n\r\n                // 모든 아이템이 준비되면 조합버튼을 활성화한다\r\n                if (itemA && itemB) {\r\n                    this.button.tint = 0xffffff;\r\n                    this.button.interactive = true;\r\n                } else {\r\n                    this.button.tint = 0x404040;\r\n                    this.button.interactive = false;\r\n                }\r\n\r\n                clicked = true;\r\n            } \r\n        }\r\n        \r\n    }\r\n}\r\n\r\nclass BattleUI extends PIXI.Container {\r\n    constructor(ui) {\r\n        super();\r\n        this.battleUi = {\r\n            playersPortraits: [],\r\n            enemiesPortraits: []\r\n        };\r\n\r\n        this.players = [];\r\n        this.enemies = [];\r\n\r\n        this.ui = ui;\r\n\r\n        this.playerUi = new PIXI.Container();\r\n        this.enemyUi = new PIXI.Container();\r\n\r\n        this.playerUi.visible = false;\r\n        this.enemyUi.visible = false;\r\n\r\n        this.addChild(this.playerUi);\r\n        this.addChild(this.enemyUi);\r\n    }\r\n\r\n    setBattleUi(players, enemies) {\r\n        this.battleUi = {\r\n            playersPortraits: [],\r\n            enemiesPortraits: []\r\n        };\r\n\r\n        this.removeChild(this.playerUi);\r\n        this.removeChild(this.enemyUi);\r\n\r\n        this.playerUi = new PIXI.Container();\r\n        this.enemyUi = new PIXI.Container();\r\n\r\n        this.makePlayerUi(players);\r\n        this.makeEnemiesUi(enemies);\r\n\r\n        this.playerUi.visible = false;\r\n        this.enemyUi.visible = false;\r\n\r\n        this.addChild(this.playerUi);\r\n        this.addChild(this.enemyUi);\r\n    }\r\n\r\n    makePlayerUi(players) {\r\n        this.players = players;\r\n\r\n        players.forEach((player, i) => {\r\n            // player정보 읽어서 뭔가 초상화 이런거 가져오겠지..\r\n            const newBattleUi = {\r\n                portrait: player.portrait,\r\n                skillA: player.skillAIcon,\r\n                skillB: player.skillBIcon\r\n            }\r\n\r\n            newBattleUi.portrait.x = 25 + i * 94;\r\n            newBattleUi.portrait.y = this.ui.screenHeight - 57 - newBattleUi.portrait.height;\r\n            newBattleUi.portrait.interactive = true;\r\n            this.playerUi.addChild(newBattleUi.portrait);\r\n\r\n            newBattleUi.skillA.x = newBattleUi.portrait.x + newBattleUi.portrait.width / 2 - newBattleUi.skillA.width - 3;\r\n            newBattleUi.skillA.y = newBattleUi.portrait.y + newBattleUi.portrait.height;\r\n            newBattleUi.skillA.interactive = true;\r\n            this.playerUi.addChild(newBattleUi.skillA);\r\n\r\n            newBattleUi.skillB.x = newBattleUi.portrait.x + newBattleUi.portrait.width / 2 + 3;\r\n            newBattleUi.skillB.y = newBattleUi.portrait.y + newBattleUi.portrait.height;\r\n            newBattleUi.skillB.interactive = true;\r\n            this.playerUi.addChild(newBattleUi.skillB);\r\n            \r\n            const style = new PIXI.TextStyle();\r\n            style.dropShadow = true;\r\n            style.dropShadowDistance = 1;\r\n            style.fontSize = 15;\r\n            style.fill = \"#ffffff\";\r\n            \r\n            const text = new PIXI.Text(player.name, style);\r\n            text.position.x = Math.round(newBattleUi.portrait.x + (newBattleUi.portrait.width/2) - text.width/2);\r\n            text.position.y = newBattleUi.portrait.y - text.height;\r\n            this.playerUi.addChild(text);\r\n\r\n            this.battleUi.playersPortraits.push(newBattleUi);\r\n        });\r\n    }\r\n\r\n    makeEnemiesUi(enemies) {\r\n        this.enemies = enemies;\r\n        enemies.forEach((enemy, i) => {\r\n            const newBattleUi = {\r\n                portrait: enemy.portrait\r\n            }\r\n\r\n            newBattleUi.portrait.x = 970 - ((enemies.length - i) * 94);\r\n            newBattleUi.portrait.y = 10;\r\n            newBattleUi.portrait.interactive = true;\r\n            this.enemyUi.addChild(newBattleUi.portrait);\r\n            \r\n            const style = new PIXI.TextStyle();\r\n            style.dropShadow = true;\r\n            style.dropShadowDistance = 1;\r\n            style.fontSize = 15;\r\n            style.fill = \"#ffffff\";\r\n            \r\n            // 우선 레벨 하드코딩..\r\n            const text = new PIXI.Text('Lv.1', style);\r\n            text.position.x = Math.round(newBattleUi.portrait.x + (newBattleUi.portrait.width/2) - text.width/2);\r\n            text.position.y = newBattleUi.portrait.y + newBattleUi.portrait.height + 3;\r\n            this.enemyUi.addChild(text);\r\n\r\n            this.battleUi.enemiesPortraits.push(newBattleUi);\r\n        });\r\n    }\r\n\r\n    showUi() {\r\n        this.playerUi.visible = true;\r\n        this.enemyUi.visible = true;\r\n    }\r\n\r\n    hideUi() {\r\n        this.playerUi.visible = false;\r\n        this.enemyUi.visible = false;\r\n    }\r\n\r\n    updateStatus(character) {\r\n        if (character.hp <= 0) {\r\n            const playerIndex = this.players.indexOf(character);\r\n            const enemyIndex = this.enemies.indexOf(character);\r\n\r\n            if (playerIndex >= 0) {\r\n                this.battleUi.playersPortraits[playerIndex].portrait.tint = 0xFF5555;\r\n            } else {\r\n                this.battleUi.enemiesPortraits[enemyIndex].portrait.tint = 0xFF5555;\r\n            }\r\n        }\r\n    }\r\n\r\n    disableInteractive() {\r\n        this.players.forEach((player, index) => {\r\n            this.battleUi.playersPortraits[index].skillA.interactive = false;\r\n            this.battleUi.playersPortraits[index].skillB.interactive = false;\r\n            this.battleUi.playersPortraits[index].skillA.removeAllListeners();\r\n            this.battleUi.playersPortraits[index].skillB.removeAllListeners();\r\n        });\r\n    }\r\n\r\n    getCommand(callback) {\r\n        this.players.forEach((player, index) => {\r\n            // 이 조건문 마음에 들지 않음..\r\n            if (player.hp > 0) {\r\n                this.battleUi.playersPortraits[index].portrait.tint = 0xBBBBBB;\r\n            }\r\n            if (player.status === 'idle') {\r\n                this.battleUi.playersPortraits[index].portrait.tint = 0xFFFFFF;\r\n                this.battleUi.playersPortraits[index].skillA.interactive = true;\r\n                this.battleUi.playersPortraits[index].skillB.interactive = true;\r\n\r\n                this.battleUi.playersPortraits[index].skillA.on('mouseup', (event) => {\r\n                    this.battleUi.playersPortraits[index].portrait.tint = 0xBBBBBB;\r\n                    callback(player, 'selectA');\r\n                    this.disableInteractive();\r\n                });\r\n\r\n                this.battleUi.playersPortraits[index].skillB.on('mouseup', (event) => {\r\n                    this.battleUi.playersPortraits[index].portrait.tint = 0xBBBBBB;\r\n                    callback(player, 'selectB');\r\n                    this.disableInteractive();\r\n                });\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\nexport default class UI extends PIXI.Container {\r\n    constructor(game) {\r\n        super();\r\n\r\n        this.game = game;\r\n        this.game.foreground.addChild(this);\r\n\r\n        this.screenWidth = game.screenWidth;\r\n        this.screenHeight = game.screenHeight;\r\n\r\n\r\n        this.dialog = new Dialog(this, 700, 150);\r\n        this.dialog.visible = false;\r\n        this.addChild(this.dialog);\r\n\r\n        this.theater = new PIXI.Sprite(PIXI.Texture.fromFrame(\"theater.png\"));\r\n        this.theater.visible =false;\r\n        this.addChild(this.theater);\r\n\r\n        this.chatBallons = [];\r\n\r\n        this.inventory = new InventoryUI(this);\r\n        this.addChild(this.inventory);\r\n        this.inventory.visible = false;\r\n\r\n        this.combine = new CombineUI(this);\r\n        this.addChild(this.combine);\r\n        this.combine.visible = false;\r\n        \r\n        this.battleUi = new BattleUI(this);\r\n        this.addChild(this.battleUi);\r\n    }\r\n    \r\n    showDialog(text, closeCallback) {\r\n        this.dialog.setText(text);\r\n        this.dialog.visible = true;\r\n        this.dialog.onclose = closeCallback;\r\n    }\r\n\r\n    hideDialog() {\r\n        this.dialog.visible = false;\r\n    }\r\n\r\n    showStageTitle(text, delay) {\r\n        // 스테이지 이름을 애니메이션 하면서 보여준다\r\n        const title = new StageTitle(this, text);\r\n        title.titleScale = 0;\r\n        title.alpha = 0;\r\n\r\n        this.addChild(title);\r\n\r\n        this.game.tweens.addTween(title, 1, { titleScale: 1, alpha: 1 }, delay | 0, \"easeInOut\", true, () => {\r\n            this.game.tweens.addTween(title, 1, { alpha: 0 }, 1, \"easeInOut\", false, () => {\r\n                this.removeChild(title);\r\n            });\r\n        });\r\n    }\r\n\r\n    showStatUI() {\r\n        // 여기서 스탯 ui 를 만든다\r\n        \r\n    }\r\n\r\n    showTheaterScreen(duration) {\r\n        // 위아래의 극장 스크린을 보여준다\r\n        const theater = this.theater;\r\n        theater.visible = true;\r\n\r\n        if (duration > 0) {\r\n            theater.alpha = 0;\r\n            this.game.tweens.addTween(theater, duration, { alpha: 1 }, 0, \"easeInOut\", true);\r\n        } else {\r\n            theater.alpha = 1;\r\n        }\r\n    }\r\n\r\n    hideTheaterScreen(duration) {\r\n        const theater = this.theater;\r\n        theater.visible = true;\r\n\r\n        if (duration > 0) {\r\n            this.game.tweens.addTween(theater, duration, { alpha: 0 }, 0, \"easeInOut\", true, () => {\r\n                theater.visible = false;\r\n            });\r\n        } else {\r\n            theater.alpha = 0;\r\n            theater.visible = false;\r\n        }\r\n    }\r\n\r\n\r\n    showItemAcquire(itemId, closeCallback) {\r\n        \r\n        const itemAcquire = new BaseModal(this, 400, 300);\r\n        itemAcquire.addTitle(\"아이템 획득\");\r\n        itemAcquire.onclose = () => {\r\n            // 자신을 부모로부터 제거한다\r\n            this.removeChild(itemAcquire);\r\n            \r\n            if (closeCallback) {\r\n                closeCallback();\r\n            }\r\n        }\r\n        this.addChild(itemAcquire);\r\n        \r\n        const itemSprite = new PIXI.Sprite(PIXI.Texture.fromFrame(\"item3.png\"));\r\n        itemSprite.anchor.x = 0.5;\r\n        itemSprite.anchor.y = 0.5;\r\n        itemSprite.position.x = itemAcquire.width / 2;\r\n        itemSprite.position.y = itemAcquire.height / 2 - 20;\r\n        itemAcquire.addChild(itemSprite);\r\n        \r\n        \r\n        let acquireText;\r\n        if (itemId === 1) {\r\n            acquireText = \"[열쇠조각A]를 얻었다\";\r\n        } else if (itemId === 2) {\r\n            acquireText = \"[열쇠조각B]를 얻었다\";\r\n        } else if (itemId === 3) {\r\n            acquireText = \"[철문열쇠]를 얻었다\";\r\n        }\r\n\r\n        const itemText = new PIXI.Text(acquireText ,{fontFamily : 'Arial', fontSize: 16, fill : 0xffffff, align : 'center', wordWrap: true, wordWrapWidth: itemAcquire.width /2 });\r\n        itemText.anchor.x = 0.5;\r\n        itemText.anchor.y = 0.5;\r\n        itemText.position.x = itemAcquire.width / 2;\r\n        itemText.position.y = itemSprite.position.y + itemSprite.height / 2 + 32;\r\n        itemAcquire.addChild(itemText);\r\n    }\r\n\r\n    showChatBallon(character, text, duration) {\r\n        // 일정시간동안 보였다가 사라지게 한다.\r\n        const chat = new ChatBallon(character, text);\r\n        this.addChild(chat);\r\n        this.chatBallons.push(chat);\r\n        duration = duration || 3;\r\n\r\n        setTimeout(() => {\r\n            this.removeChild(chat);\r\n            const index = this.chatBallons.indexOf(chat);\r\n            if (index >= 0) {\r\n                this.chatBallons.splice(index, 1);\r\n            }\r\n        }, duration * 1000);\r\n    }\r\n\r\n    update() {\r\n        // 풍선들을 관리한다\r\n        for (const chat of this.chatBallons) {\r\n            chat.updatePosition();\r\n        }\r\n    }\r\n\r\n    showInventory() {\r\n        this.inventory.visible = true;\r\n        this.inventory.update(this.game.player.inventory);\r\n    }\r\n\r\n    hideInventory() {\r\n        this.inventory.visible = false;\r\n    }\r\n\r\n    showCombine() {\r\n        this.combine.visible = true;\r\n        this.combine.update(this.game);\r\n    }\r\n\r\n    hideCombine() {\r\n        this.combine.visible = false;\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/ui.js","module.exports = __webpack_public_path__ + \"src/assets/theater.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/theater.png\n// module id = qTO+\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/items/item3.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/items/item3.png\n// module id = r15H\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/elid/elid_idle_sw.json\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/elid/elid_idle_sw.json\n// module id = rki7\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/torch_light.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/torch_light.png\n// module id = sARW\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/player3_active2.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/player3_active2.png\n// module id = sskf\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/opening.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/opening.png\n// module id = tSQQ\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/titan/monster2-atk_sw.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/titan/monster2-atk_sw.png\n// module id = uCLC\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/player2_active2.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/player2_active2.png\n// module id = uGjp\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/player1_active2.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/player1_active2.png\n// module id = ufHM\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/elid/elid_death_nw.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/elid/elid_death_nw.png\n// module id = v5Cq\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/night/sword_nw.json\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/night/sword_nw.json\n// module id = v8ZX\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/ch03_skill01_on.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/ch03_skill01_on.png\n// module id = vDF+\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/night/sword_nw.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/night/sword_nw.png\n// module id = vIzp\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/medusa/monster1_idle_sw.json\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/medusa/monster1_idle_sw.json\n// module id = vW6P\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/elid/elid_atk_nw.json\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/elid/elid_atk_nw.json\n// module id = vbJk\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/ch02_skill01.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/ch02_skill01.png\n// module id = wCSF\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/windowlight.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/windowlight.png\n// module id = x0Wi\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/mapdata/tiles.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/mapdata/tiles.png\n// module id = xGYh\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/ch03_skill02_on.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/ch03_skill02_on.png\n// module id = xnvo\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/night/atk_sw.json\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/night/atk_sw.json\n// module id = xykr\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/medusa/monster1_idle_sw.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/medusa/monster1_idle_sw.png\n// module id = y7rX\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/dialogtitle.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/dialogtitle.png\n// module id = yDv2\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/shadow.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/shadow.png\n// module id = z8NX\n// module chunks = 1","module.exports = __webpack_public_path__ + \"src/assets/night/idle_nw.json\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/night/idle_nw.json\n// module id = zPL7\n// module chunks = 1","import { DIRECTIONS } from './define';\r\n\r\nfunction loadAniTexture(name, count) {\r\n    const frames = [];  \r\n    for (let i = 0; i < count; i++) {\r\n        frames.push(PIXI.Texture.fromFrame(name + i + '.png'));\r\n    }\r\n    return frames;\r\n}\r\n\r\nfunction getDirectionName(dir) {\r\n    if (dir === DIRECTIONS.SE) {\r\n        return 'se';\r\n    } else if (dir === DIRECTIONS.NW) {\r\n        return 'nw';\r\n    } else if (dir === DIRECTIONS.NE) {\r\n        return 'ne';\r\n    } else if (dir === DIRECTIONS.SW) {\r\n        return 'sw';\r\n    }\r\n}\r\n\r\nexport default class Character extends PIXI.Container {\r\n    constructor() {\r\n        super();\r\n\r\n        this.gridX = 0;\r\n        this.gridY = 0;\r\n\r\n        this.status = 'idle';\r\n        this.container = new PIXI.Container();\r\n\r\n\r\n        // 스프라이트를 읽어와서 애니메이션을 시킨다.\r\n        // 아이들 애니메이션을 읽어온다\r\n        this.animations = {};\r\n\r\n        // 그림자를 추가한다\r\n        const shadow = new PIXI.Sprite(PIXI.Texture.fromFrame(\"shadow.png\"));\r\n        shadow.position.y = -shadow.height;\r\n        this.container.addChild(shadow);\r\n\r\n        const hpHolder = new PIXI.Sprite(PIXI.Texture.fromFrame(\"pbar.png\"));\r\n        const hpBar = new PIXI.Sprite(PIXI.Texture.fromFrame(\"pbar_r.png\"));\r\n\r\n        this.hpHolder = hpHolder;\r\n        this.hpBar = hpBar;\r\n        this.hpHolder.alpha = 0;\r\n        this.hpBar.alpha = 0;\r\n\r\n        this.container.addChild(hpHolder);\r\n        this.container.addChild(hpBar);\r\n\r\n        this.currentDir = DIRECTIONS.SW;\r\n\r\n        this.addChild(this.container);\r\n    }\r\n\r\n    setUiVisible(game, flag) {\r\n        const hpWidth = this.hp / this.maxHp * 34;\r\n        this.hpBar.width = hpWidth;\r\n\r\n        if (flag) {\r\n            game.tweens.addTween(this.hpHolder, 0.5, { alpha: 1 }, 0, \"easeInOut\", true);\r\n            game.tweens.addTween(this.hpBar, 0.5, { alpha: 1 }, 0, \"easeInOut\", true);\r\n        } else {\r\n            game.tweens.addTween(this.hpHolder, 0.5, { alpha: 0 }, 0, \"linear\", true);\r\n            game.tweens.addTween(this.hpBar, 0.5, { alpha: 0 }, 0, \"linear\", true);\r\n        }\r\n    }\r\n\r\n    onDamage(game, damage, options) {\r\n        this.hp -= damage;\r\n        let hpWidth = (this.hp < 0 ? 0 : this.hp) / this.maxHp * 34;\r\n        if (options.critical) {\r\n            game.whiteScreen.alpha = 0.2;\r\n            game.tweens.addTween(game.whiteScreen, 0.1, { alpha: 0 }, 0, \"easeInOut\", true);\r\n            game.stage.vibrateObj(game.stage.mapContainer, 6, null);\r\n        }\r\n        // Effect 작성해보자.\r\n        // 여기 메모리 낭비.. 계속 addChild로 animated sprite 박고 있어서 문제가 될 듯하다. 어떻게 해야할까..\r\n        // 심지어 이펙트 쪽으로 빼야할듯..\r\n        // 이것을 빼면서.. Character 내부에 뜨는 Damage 도 다른 Container에 생성해야할듯싶다..\r\n        const slash = { textures: loadAniTexture(\"slash_\", 8), flipX: false };\r\n        const anim = new PIXI.extras.AnimatedSprite(slash.textures);\r\n        anim.animationSpeed = 0.5;\r\n        anim.loop = false;\r\n        anim.blendMode = PIXI.BLEND_MODES.ADD;\r\n        anim.play();\r\n        anim.position.y = -anim.height;\r\n        anim.position.x = -anim.width / 4;\r\n        this.container.addChild(anim);\r\n\r\n        // UI에서 데미지 받았을때 처리.\r\n        game.ui.battleUi.updateStatus(this);\r\n\r\n        game.tweens.addTween(this.hpBar, 0.5, { width: hpWidth }, 0, \"easeInOut\", true);\r\n        game.stage.vibrateObj(this.anim, 4, () => { this.checkDie(); });\r\n    }\r\n\r\n    checkDie() {\r\n        // tween으로 작성할것...\r\n        var func = () => {\r\n            setTimeout(() => {\r\n                if (this.container.alpha >= 0.1) {\r\n                    this.container.alpha -= 0.1;\r\n                    func();\r\n                } else {\r\n                    this.container.alpha = 0;\r\n                }\r\n            }, 20);\r\n        };\r\n\r\n        if (this.hp <= 0) {\r\n            this.status = 'die';\r\n            func();\r\n        }\r\n    }\r\n\r\n   \r\n    setAnimation(name) {\r\n        const ani = this.animations[name];\r\n        if (ani && this.anim.name !== name) {\r\n            this.anim.name = name;\r\n            this.anim.textures = ani.textures;\r\n            this.anim.scale.x = ani.flipX ? -1 : 1;\r\n            this.anim.position.x = ani.flipX ? this.anim.width : 0;\r\n            this.anim.gotoAndPlay(0);\r\n\r\n        }\r\n    }\r\n\r\n    changeVisualToDirection(direction) {\r\n        this.currentDir = direction;\r\n        if (this.isMoving) {\r\n            // 이동 애니메이션\r\n            this.setAnimation('walk_' + getDirectionName(direction));\r\n        } else {\r\n            this.setAnimation('idle_' + getDirectionName(direction));\r\n        }\r\n    }    \r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/character.js"],"sourceRoot":""}